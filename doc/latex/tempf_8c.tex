\hypertarget{tempf_8c}{\section{tempf.\-c File Reference}
\label{tempf_8c}\index{tempf.\-c@{tempf.\-c}}
}


contains functions used for solving temperature field  


{\ttfamily \#include \char`\"{}\-\_\-hypre\-\_\-utilities.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}H\-Y\-P\-R\-E\-\_\-sstruct\-\_\-ls.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}H\-Y\-P\-R\-E\-\_\-parcsr\-\_\-ls.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}H\-Y\-P\-R\-E\-\_\-krylov.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}global.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fields.\-h\char`\"{}}\\*
Include dependency graph for tempf.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tempf_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{temp\-Set\-Boundary} (int coord, int boundary)
\item 
void \hyperlink{tempf_8c_afdd72425d842d0527b7707235c6b1426}{temp\-Env\-Init\-System} ()
\item 
void \hyperlink{tempf_8c_aa500322cb37c8e4f6b5cdd19f7f4c52a}{temp\-Env\-Init\-B\-C} ()
\item 
void \hyperlink{tempf_8c_a03c57aff346d1ca0f30a1cbe5d74110d}{temp\-Env\-Init\-Solver} ()
\item 
void \hyperlink{tempf_8c_a7e47d73682b9a931fd9d680f6d495331}{temp\-Env\-Solve} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Grid \hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{temp\-Grid}
\item 
H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Graph \hyperlink{tempf_8c_a8e4efbbc574194c74f201b9328263d51}{temp\-Graph}
\item 
H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Stencil \hyperlink{tempf_8c_a8e2e31e96bb8622f2b457c7a631b0b17}{temp\-Stencil}
\item 
H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Matrix \hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}
\item 
H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Vector \hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}
\item 
H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Vector \hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}
\item 
H\-Y\-P\-R\-E\-\_\-\-Par\-C\-S\-R\-Matrix \hyperlink{tempf_8c_af2d53284d0549b262215b77eb3fc5cad}{par\-A}
\item 
H\-Y\-P\-R\-E\-\_\-\-Par\-Vector \hyperlink{tempf_8c_a22c8c44999d3430aef3e02c8081b9d9e}{parb}
\item 
H\-Y\-P\-R\-E\-\_\-\-Par\-Vector \hyperlink{tempf_8c_a2a202d5a6f9421afac04dc63cc35ce6f}{parx}
\item 
H\-Y\-P\-R\-E\-\_\-\-Solver \hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{temp\-Solver}
\item 
H\-Y\-P\-R\-E\-\_\-\-Solver \hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{temp\-Precond}
\item 
int \hyperlink{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}{temp\-Object\-Type}
\item 
long long \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{temp\-Lower} \mbox{[}3\mbox{]}
\item 
long long \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{temp\-Upper} \mbox{[}3\mbox{]}
\item 
long long \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bc\-Lower} \mbox{[}3\mbox{]}
\item 
long long \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bc\-Upper} \mbox{[}3\mbox{]}
\item 
double \hyperlink{tempf_8c_a03e28be41881b703c836edbfe9b51b17}{dt}
\item 
double \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{temp\-Lambda} = 0.\-25
\item 
char \hyperlink{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}{tfname} \mbox{[}256\mbox{]}
\item 
int \hyperlink{tempf_8c_a61d9e9d52407e9c24553063b99088457}{temp\-N\-Vars}
\item 
int \hyperlink{tempf_8c_a5d7b5d2a5e1ad21ae8f4bd43f0392276}{temp\-N\-Parts}
\item 
int \hyperlink{tempf_8c_a99cc2555bf46405acb3e2b14e8567604}{temp\-Iter}
\item 
H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Variable \hyperlink{tempf_8c_a10ce94c724b037f8ef4c4d6c9bcbbb94}{temp\-Vartypes} \mbox{[}1\mbox{]} = \{ H\-Y\-P\-R\-E\-\_\-\-S\-S\-T\-R\-U\-C\-T\-\_\-\-V\-A\-R\-I\-A\-B\-L\-E\-\_\-\-N\-O\-D\-E \}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
contains functions used for solving temperature field 

Definition in file \hyperlink{tempf_8c_source}{tempf.\-c}.



\subsection{Function Documentation}
\hypertarget{tempf_8c_aa500322cb37c8e4f6b5cdd19f7f4c52a}{\index{tempf.\-c@{tempf.\-c}!temp\-Env\-Init\-B\-C@{temp\-Env\-Init\-B\-C}}
\index{temp\-Env\-Init\-B\-C@{temp\-Env\-Init\-B\-C}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Env\-Init\-B\-C}]{\setlength{\rightskip}{0pt plus 5cm}void temp\-Env\-Init\-B\-C (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{tempf_8c_aa500322cb37c8e4f6b5cdd19f7f4c52a}
This function computes cell oxygen consumption function based on the interpolated cell density field. 

Definition at line 223 of file tempf.\-c.



References A, b, bc\-Lower, bc\-Upper, dt, field\-B\-C, field\-I\-C\-Mean, grid\-Resolution, grid\-Size, m, M\-P\-I\-\_\-\-C\-A\-R\-T\-\_\-\-C\-O\-M\-M, M\-P\-Icoords, M\-P\-Idim, M\-P\-Irank, revert\-Std\-Out(), switch\-Std\-Out(), T\-E\-M\-P, temp\-Grid, temp\-Lambda, temp\-Lower, temp\-Object\-Type, temp\-Set\-Boundary(), temp\-Upper, tfname, x, int64\-Vector3d\-::x, int64\-Vector3d\-::y, int64\-Vector3d\-::z, and uint\-Vector3d\-::z.


\begin{DoxyCode}
224 \{
225   \textcolor{keywordtype}{int} i, j, k;
226   \textcolor{keywordtype}{int} \hyperlink{global_8h_ac51334f57ef8b81c0629c9421798c344}{m};
227   \textcolor{keywordtype}{int} nvalues;
228   \textcolor{keywordtype}{int} nentries;
229   \textcolor{keywordtype}{double} *values, *bvalues;
230   \textcolor{keywordtype}{double} \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
231   z = \hyperlink{tempf_8c_a03e28be41881b703c836edbfe9b51b17}{dt} / (\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
232   \textcolor{comment}{/* stdout redirected to file */}
233   \hyperlink{io_8c_a62f5074e9f833de4cbf65a82dbb2f81b}{switchStdOut}(\hyperlink{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}{tfname});
234 
235   \textcolor{comment}{/* 5. SETUP STRUCT VECTORS FOR B AND X */}
236   nvalues = \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
237 
238   values = calloc(nvalues, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
239 
240   \textcolor{comment}{/* create an empty vector object */}
241   HYPRE\_SStructVectorCreate(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM}, \hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{tempGrid}, &\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b});
242   HYPRE\_SStructVectorCreate(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM}, \hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{tempGrid}, &\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x});
243 
244   \textcolor{comment}{/* as with the matrix, set the appropriate object type for the vectors */}
245   HYPRE\_SStructVectorSetObjectType(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, \hyperlink{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}{tempObjectType});
246   HYPRE\_SStructVectorSetObjectType(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}, \hyperlink{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}{tempObjectType});
247 
248   \textcolor{comment}{/* indicate that the vector coefficients are ready to be set */}
249   HYPRE\_SStructVectorInitialize(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b});
250   HYPRE\_SStructVectorInitialize(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x});
251 
252   \textcolor{comment}{/* set the values */}
253   m = 0;
254   \textcolor{keywordflow}{for} (k = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2]; k <= \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2]; k++)
255     \textcolor{keywordflow}{for} (j = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1]; j <= \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1]; j++)
256       \textcolor{keywordflow}{for} (i = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0]; i <= \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0]; i++) \{
257         values[\hyperlink{global_8h_ac51334f57ef8b81c0629c9421798c344}{m}] = \hyperlink{fields_8h_ad0fb86debb3e1b138683ff94a2f51f5b}{fieldICMean}[\hyperlink{fields_8h_a10bed19ceedeb2c12c5aad6de1d3b1a1}{TEMP}];
258         m++;
259       \}
260 
261   HYPRE\_SStructVectorSetBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}, \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}, 0, values);
262 
263   m = 0;
264   \textcolor{keywordflow}{for} (k = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2]; k <= \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2]; k++)
265     \textcolor{keywordflow}{for} (j = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1]; j <= \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1]; j++)
266       \textcolor{keywordflow}{for} (i = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0]; i <= \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0]; i++) \{
267         values[\hyperlink{global_8h_ac51334f57ef8b81c0629c9421798c344}{m}] = \hyperlink{fields_8h_ad0fb86debb3e1b138683ff94a2f51f5b}{fieldICMean}[\hyperlink{fields_8h_a10bed19ceedeb2c12c5aad6de1d3b1a1}{TEMP}];
268         m++;
269       \}
270 
271   HYPRE\_SStructVectorSetBoxValues(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}, 0, \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}, \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}, 0, values);
272 
273   free(values);
274 
275   \textcolor{comment}{/* incorporate boundary conditions; Dirichlet on 1 face; Robin on 7 other faces (low X) */}
276 
277   \textcolor{comment}{/* Robin conditions */}
278   nentries = 3;
279   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} stencilRindices[3];
280   \textcolor{keywordtype}{int} Nmax;
281   Nmax = 0;
282   Nmax = (Nmax < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} ? \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} : Nmax);
283   Nmax = (Nmax < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} ? \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} : Nmax);
284   Nmax = (Nmax < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} ? \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} : Nmax);
285   values = calloc(nentries * Nmax * Nmax, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
286   bvalues = calloc(Nmax * Nmax, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
287 
288   \textcolor{keywordflow}{for} (i = 0; i < Nmax * Nmax; i++)
289     bvalues[i] = 2.0 * z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{tempLambda} * 
      \hyperlink{fields_8h_ad0fb86debb3e1b138683ff94a2f51f5b}{fieldICMean}[\hyperlink{fields_8h_a10bed19ceedeb2c12c5aad6de1d3b1a1}{TEMP}];
290 
291   \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][0] == \hyperlink{global_8h_a633835398408aaee46fd56809af73e6c}{MPIdim}[0] - 1) \{
292     nvalues = nentries * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
293     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i += nentries) \{
294       values[i] = 2.0 * z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{tempLambda};
295       values[i + 1] = \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
296       values[i + 2] = -\hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
297     \}
298 
299     \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(0, 1);
300 
301     stencilRindices[0] = 0;
302     stencilRindices[1] = 2;
303     stencilRindices[2] = 1;
304 
305     HYPRE\_SStructMatrixAddToBoxValues(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, nentries,
306                                       stencilRindices, values);
307 
308     HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, bvalues);
309 
310   \}
311 
312   \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][1] == 0) \{
313     nvalues = nentries * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
314     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i += nentries) \{
315       values[i] = 2.0 * z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{tempLambda};
316       values[i + 1] = \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
317       values[i + 2] = -\hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
318     \}
319 
320     \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(1, -1);
321 
322     stencilRindices[0] = 0;
323     stencilRindices[1] = 3;
324     stencilRindices[2] = 4;
325 
326     HYPRE\_SStructMatrixAddToBoxValues(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, nentries,
327                                       stencilRindices, values);
328 
329     HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, bvalues);
330 
331   \}
332 
333   \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][1] == \hyperlink{global_8h_a633835398408aaee46fd56809af73e6c}{MPIdim}[1] - 1) \{
334     nvalues = nentries * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
335     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i += nentries) \{
336       values[i] = 2.0 * z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{tempLambda};
337       values[i + 1] = \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
338       values[i + 2] = -\hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
339     \}
340 
341     \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(1, 1);
342 
343     stencilRindices[0] = 0;
344     stencilRindices[1] = 4;
345     stencilRindices[2] = 3;
346 
347     HYPRE\_SStructMatrixAddToBoxValues(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, nentries,
348                                       stencilRindices, values);
349 
350     HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, bvalues);
351 
352   \}
353 
354   \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][2] == 0) \{
355     nvalues = nentries * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
356     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i += nentries) \{
357       values[i] = 2.0 * z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{tempLambda};
358       values[i + 1] = \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
359       values[i + 2] = -\hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
360     \}
361 
362     \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(2, -1);
363 
364     stencilRindices[0] = 0;
365     stencilRindices[1] = 5;
366     stencilRindices[2] = 6;
367 
368     HYPRE\_SStructMatrixAddToBoxValues(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, nentries,
369                                       stencilRindices, values);
370 
371     HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, bvalues);
372 
373   \}
374 
375   \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][2] == \hyperlink{global_8h_a633835398408aaee46fd56809af73e6c}{MPIdim}[2] - 1) \{
376     nvalues = nentries * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
377     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i += nentries) \{
378       values[i] = 2.0 * z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{tempLambda};
379       values[i + 1] = \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
380       values[i + 2] = -\hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
381     \}
382 
383     \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(2, 1);
384 
385     stencilRindices[0] = 0;
386     stencilRindices[1] = 6;
387     stencilRindices[2] = 5;
388 
389     HYPRE\_SStructMatrixAddToBoxValues(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, nentries,
390                                       stencilRindices, values);
391 
392     HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, bvalues);
393 
394   \}
395 
396   free(values);
397   free(bvalues);
398 
399   \textcolor{comment}{/* Dirichlet conditions */}
400   \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][0] == 0) \{
401 
402     \textcolor{keywordtype}{int} nentries = 1;
403     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} stencilDindices[1];
404     nvalues = nentries * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
405     values = calloc(nvalues, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
406     bvalues = calloc(nvalues, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
407     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i++)
408       values[i] = z;
409 
410     \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(0, -1);
411 
412     stencilDindices[0] = 1;
413 
414     HYPRE\_SStructMatrixAddToBoxValues(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, nentries,
415                                       stencilDindices, values);
416 
417     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i++)
418       bvalues[i] = z * \hyperlink{fields_8h_a80c6ee80e0f056adba2430ab0d21e58f}{fieldBC}[\hyperlink{fields_8h_a10bed19ceedeb2c12c5aad6de1d3b1a1}{TEMP}];
419 
420     HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, bvalues);
421 
422     free(values);
423     free(bvalues);
424   \}
425   \textcolor{comment}{/* stdout brought back */}
426   \hyperlink{io_8c_affa00173da9bea48973a6ac887d505bb}{revertStdOut}();
427 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{tempf_8c_aa500322cb37c8e4f6b5cdd19f7f4c52a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tempf_8c_aa500322cb37c8e4f6b5cdd19f7f4c52a_icgraph}
\end{center}
\end{figure}


\hypertarget{tempf_8c_a03c57aff346d1ca0f30a1cbe5d74110d}{\index{tempf.\-c@{tempf.\-c}!temp\-Env\-Init\-Solver@{temp\-Env\-Init\-Solver}}
\index{temp\-Env\-Init\-Solver@{temp\-Env\-Init\-Solver}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Env\-Init\-Solver}]{\setlength{\rightskip}{0pt plus 5cm}void temp\-Env\-Init\-Solver (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{tempf_8c_a03c57aff346d1ca0f30a1cbe5d74110d}
This function initializes Hypre for solving temperature field. 

Definition at line 432 of file tempf.\-c.



References A, b, M\-P\-I\-\_\-\-C\-A\-R\-T\-\_\-\-C\-O\-M\-M, par\-A, parb, parx, revert\-Std\-Out(), switch\-Std\-Out(), temp\-Precond, temp\-Solver, tfname, and x.


\begin{DoxyCode}
433 \{
434   \textcolor{comment}{/* stdout redirected to file */}
435   \hyperlink{io_8c_a62f5074e9f833de4cbf65a82dbb2f81b}{switchStdOut}(\hyperlink{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}{tfname});
436 
437   HYPRE\_SStructMatrixAssemble(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A});
438   \textcolor{comment}{/* This is a collective call finalizing the vector assembly.}
439 \textcolor{comment}{     The vector is now ``ready to be used'' */}
440   HYPRE\_SStructVectorAssemble(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b});
441   HYPRE\_SStructVectorAssemble(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x});
442 
443   HYPRE\_SStructMatrixGetObject(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, (\textcolor{keywordtype}{void} **) &\hyperlink{tempf_8c_af2d53284d0549b262215b77eb3fc5cad}{parA});
444   HYPRE\_SStructVectorGetObject(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, (\textcolor{keywordtype}{void} **) &\hyperlink{tempf_8c_a22c8c44999d3430aef3e02c8081b9d9e}{parb});
445   HYPRE\_SStructVectorGetObject(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}, (\textcolor{keywordtype}{void} **) &\hyperlink{tempf_8c_a2a202d5a6f9421afac04dc63cc35ce6f}{parx});
446 
447   HYPRE\_ParCSRPCGCreate(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM}, &\hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{tempSolver});
448   HYPRE\_ParCSRPCGSetTol(\hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{tempSolver}, 1.0e-12);
449   HYPRE\_ParCSRPCGSetPrintLevel(\hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{tempSolver}, 0);
450   HYPRE\_ParCSRPCGSetMaxIter(\hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{tempSolver}, 50);
451 
452   HYPRE\_BoomerAMGCreate(&\hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond});
453   HYPRE\_BoomerAMGSetMaxIter(\hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond}, 1);
454   HYPRE\_BoomerAMGSetTol(\hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond}, 0.0);
455   HYPRE\_BoomerAMGSetPrintLevel(\hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond}, 0);
456   HYPRE\_BoomerAMGSetCoarsenType(\hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond}, 6);
457   HYPRE\_BoomerAMGSetRelaxType(\hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond}, 6);
458   HYPRE\_BoomerAMGSetNumSweeps(\hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond}, 1);
459 
460   HYPRE\_ParCSRPCGSetPrecond(\hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{tempSolver}, HYPRE\_BoomerAMGSolve,
461                             HYPRE\_BoomerAMGSetup, \hyperlink{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{tempPrecond});
462   HYPRE\_ParCSRPCGSetup(\hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{tempSolver}, \hyperlink{tempf_8c_af2d53284d0549b262215b77eb3fc5cad}{parA}, \hyperlink{tempf_8c_a22c8c44999d3430aef3e02c8081b9d9e}{parb}, \hyperlink{tempf_8c_a2a202d5a6f9421afac04dc63cc35ce6f}{parx});
463   \textcolor{comment}{/* stdout brought back */}
464   \hyperlink{io_8c_affa00173da9bea48973a6ac887d505bb}{revertStdOut}();
465 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=290pt]{tempf_8c_a03c57aff346d1ca0f30a1cbe5d74110d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tempf_8c_a03c57aff346d1ca0f30a1cbe5d74110d_icgraph}
\end{center}
\end{figure}


\hypertarget{tempf_8c_afdd72425d842d0527b7707235c6b1426}{\index{tempf.\-c@{tempf.\-c}!temp\-Env\-Init\-System@{temp\-Env\-Init\-System}}
\index{temp\-Env\-Init\-System@{temp\-Env\-Init\-System}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Env\-Init\-System}]{\setlength{\rightskip}{0pt plus 5cm}void temp\-Env\-Init\-System (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{tempf_8c_afdd72425d842d0527b7707235c6b1426}
This function initializes grid, stencil and matrix for temperature field. 

Definition at line 126 of file tempf.\-c.



References A, dt, grid\-End\-Idx, grid\-Resolution, grid\-Size, grid\-Start\-Idx, logdir, M\-P\-I\-\_\-\-C\-A\-R\-T\-\_\-\-C\-O\-M\-M, M\-P\-Irank, revert\-Std\-Out(), switch\-Std\-Out(), temp\-Graph, temp\-Grid, temp\-Iter, temp\-Lower, temp\-N\-Parts, temp\-N\-Vars, temp\-Object\-Type, temp\-Stencil, temp\-Upper, temp\-Vartypes, tfname, int64\-Vector3d\-::x, int64\-Vector3d\-::y, int64\-Vector3d\-::z, and uint\-Vector3d\-::z.


\begin{DoxyCode}
127 \{
128   \textcolor{keywordtype}{int} i,j;
129   \textcolor{keywordtype}{double} \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
130   \textcolor{keywordtype}{int} entry;
131   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} offsets[7][3] = \{
132     \{0, 0, 0\}, \{-1, 0, 0\}, \{1, 0, 0\}, \{0, -1, 0\}, \{0, 1, 0\}, \{
133       0, 0,
134       -1
135     \}, \{
136       0,
137       0,
138       1
139     \}
140   \};
141 
142   \hyperlink{tempf_8c_a03e28be41881b703c836edbfe9b51b17}{dt} = 0.1;
143   \hyperlink{tempf_8c_a99cc2555bf46405acb3e2b14e8567604}{tempIter} = 0;
144   \hyperlink{tempf_8c_a61d9e9d52407e9c24553063b99088457}{tempNVars} = 1;
145   \hyperlink{tempf_8c_a5d7b5d2a5e1ad21ae8f4bd43f0392276}{tempNParts} = 1;
146 
147   sprintf(\hyperlink{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}{tfname}, \textcolor{stringliteral}{"%s/tempSolver.log"}, \hyperlink{global_8h_a58bd7d9996cba89c834ae9ec41bbc075}{logdir});
148   \textcolor{comment}{/* stdout redirected to file */}
149   \hyperlink{io_8c_a62f5074e9f833de4cbf65a82dbb2f81b}{switchStdOut}(\hyperlink{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}{tfname});
150 
151   \textcolor{comment}{/* 1. INIT GRID */}
152 
153   \textcolor{comment}{/* create an empty 3D grid object */}
154   HYPRE\_SStructGridCreate(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM}, 3, \hyperlink{tempf_8c_a5d7b5d2a5e1ad21ae8f4bd43f0392276}{tempNParts}, &
      \hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{tempGrid});
155 
156   \textcolor{comment}{/* set this process box */}
157   \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0] = \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
158   \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1] = \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
159   \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2] = \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
160 
161   \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0] = \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
162   \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1] = \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
163   \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2] = \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
164 
165   \textcolor{comment}{/* add a new box to the grid */}
166   HYPRE\_SStructGridSetExtents(\hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{tempGrid}, 0, \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}, \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper});
167 
168   HYPRE\_SStructGridSetVariables(\hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{tempGrid}, 0, \hyperlink{tempf_8c_a61d9e9d52407e9c24553063b99088457}{tempNVars}, 
      \hyperlink{tempf_8c_a10ce94c724b037f8ef4c4d6c9bcbbb94}{tempVartypes});
169   HYPRE\_SStructGridAssemble(\hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{tempGrid});
170 
171   \textcolor{comment}{/*  2. INIT STENCIL */}
172   HYPRE\_SStructStencilCreate(3, 7, &\hyperlink{tempf_8c_a8e2e31e96bb8622f2b457c7a631b0b17}{tempStencil});
173   \textcolor{keywordflow}{for} (entry = 0; entry < 7; entry++)
174     HYPRE\_SStructStencilSetEntry(\hyperlink{tempf_8c_a8e2e31e96bb8622f2b457c7a631b0b17}{tempStencil}, entry, offsets[entry], 0);
175 
176   \textcolor{comment}{/* 3. SET UP THE GRAPH */}
177   \hyperlink{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}{tempObjectType} = HYPRE\_PARCSR;
178   HYPRE\_SStructGraphCreate(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM}, \hyperlink{tempf_8c_a306941a728f83331c95c2355cbad756e}{tempGrid}, &
      \hyperlink{tempf_8c_a8e4efbbc574194c74f201b9328263d51}{tempGraph});
179   HYPRE\_SStructGraphSetObjectType(\hyperlink{tempf_8c_a8e4efbbc574194c74f201b9328263d51}{tempGraph}, \hyperlink{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}{tempObjectType});
180   HYPRE\_SStructGraphSetStencil(\hyperlink{tempf_8c_a8e4efbbc574194c74f201b9328263d51}{tempGraph}, 0, 0, \hyperlink{tempf_8c_a8e2e31e96bb8622f2b457c7a631b0b17}{tempStencil});
181   HYPRE\_SStructGraphAssemble(\hyperlink{tempf_8c_a8e4efbbc574194c74f201b9328263d51}{tempGraph});
182 
183   \textcolor{comment}{/* 4. SET UP MATRIX */}
184   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} nentries = 7;
185   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} nvalues;
186   \textcolor{keywordtype}{double} *values;
187   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} stencil\_indices[7];
188 
189   nvalues = nentries * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
190   \textcolor{comment}{/* create an empty matrix object */}
191   HYPRE\_SStructMatrixCreate(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM}, \hyperlink{tempf_8c_a8e4efbbc574194c74f201b9328263d51}{tempGraph}, &\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A});
192   HYPRE\_SStructMatrixSetObjectType(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, \hyperlink{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}{tempObjectType});
193   \textcolor{comment}{/* indicate that the matrix coefficients are ready to be set */}
194   HYPRE\_SStructMatrixInitialize(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A});
195 
196   values = calloc(nvalues, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
197 
198   \textcolor{keywordflow}{for} (j = 0; j < nentries; j++)
199     stencil\_indices[j] = j;
200 
201   z = \hyperlink{tempf_8c_a03e28be41881b703c836edbfe9b51b17}{dt} / (\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
202 
203   \textcolor{comment}{/* set the standard stencil at each grid point,}
204 \textcolor{comment}{   * we will fix the boundaries later */}
205   \textcolor{keywordflow}{for} (i = 0; i < nvalues; i += nentries) \{
206     values[i] = 1 + 6.0 * \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
207     \textcolor{keywordflow}{for} (j = 1; j < nentries; j++)
208       values[i + j] = -z;
209   \}
210 
211   HYPRE\_SStructMatrixSetBoxValues(\hyperlink{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{A}, 0, \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}, \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}, 0, nentries,
212                                   stencil\_indices, values);
213 
214   free(values);
215   \textcolor{comment}{/* stdout brought back */}
216   \hyperlink{io_8c_affa00173da9bea48973a6ac887d505bb}{revertStdOut}();
217 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{tempf_8c_afdd72425d842d0527b7707235c6b1426_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tempf_8c_afdd72425d842d0527b7707235c6b1426_icgraph}
\end{center}
\end{figure}


\hypertarget{tempf_8c_a7e47d73682b9a931fd9d680f6d495331}{\index{tempf.\-c@{tempf.\-c}!temp\-Env\-Solve@{temp\-Env\-Solve}}
\index{temp\-Env\-Solve@{temp\-Env\-Solve}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Env\-Solve}]{\setlength{\rightskip}{0pt plus 5cm}void temp\-Env\-Solve (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{tempf_8c_a7e47d73682b9a931fd9d680f6d495331}
This function is a driving function for the solving next time step of temperature field. 

Definition at line 471 of file tempf.\-c.



References b, bc\-Lower, bc\-Upper, dt, field\-B\-C, field\-I\-C\-Mean, grid\-Resolution, grid\-Size, M\-P\-Icoords, M\-P\-Idim, M\-P\-Irank, par\-A, parb, parx, revert\-Std\-Out(), switch\-Std\-Out(), T\-E\-M\-P, temp\-Field, temp\-Iter, temp\-Lambda, temp\-Lower, temp\-Set\-Boundary(), temp\-Solver, temp\-Upper, tfname, x, int64\-Vector3d\-::x, int64\-Vector3d\-::y, int64\-Vector3d\-::z, and uint\-Vector3d\-::z.


\begin{DoxyCode}
472 \{
473 
474   \textcolor{keywordtype}{int} i, j, k;
475   \textcolor{keywordtype}{int} idx;
476   \textcolor{keywordtype}{double} \hyperlink{structuintVector3d_a3d99b005d0fb73033dce14d4a135d01f}{z};
477   \textcolor{keywordtype}{double} *values;
478   \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} nvalues = \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
479   z = \hyperlink{tempf_8c_a03e28be41881b703c836edbfe9b51b17}{dt} / (\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
480   \textcolor{comment}{/* stdout redirected to file */}
481   \hyperlink{io_8c_a62f5074e9f833de4cbf65a82dbb2f81b}{switchStdOut}(\hyperlink{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}{tfname});
482 
483   \textcolor{keywordflow}{if} (\hyperlink{tempf_8c_a99cc2555bf46405acb3e2b14e8567604}{tempIter} > 0) \{
484 
485     \textcolor{comment}{/* update right hand side */}
486 
487     values = calloc(nvalues, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
488 
489     HYPRE\_SStructVectorGetBoxValues(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}, 0, \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}, \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}, 0, values);
490     HYPRE\_SStructVectorSetBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}, \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}, 0, values);
491 
492     \textcolor{keywordflow}{for} (i = 0; i < nvalues; i++)
493       values[i] =
494         2.0 * z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution} * \hyperlink{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{tempLambda} * 
      \hyperlink{fields_8h_ad0fb86debb3e1b138683ff94a2f51f5b}{fieldICMean}[\hyperlink{fields_8h_a10bed19ceedeb2c12c5aad6de1d3b1a1}{TEMP}];
495 
496     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][0] == \hyperlink{global_8h_a633835398408aaee46fd56809af73e6c}{MPIdim}[0] - 1) \{
497       \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(0, 1);
498       HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, values);
499     \}
500     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][1] == 0) \{
501       \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(1, -1);
502       HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, values);
503     \}
504     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][1] == \hyperlink{global_8h_a633835398408aaee46fd56809af73e6c}{MPIdim}[1] - 1) \{
505       \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(1, 1);
506       HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, values);
507     \}
508     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][2] == 0) \{
509       \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(2, -1);
510       HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, values);
511     \}
512     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][2] == \hyperlink{global_8h_a633835398408aaee46fd56809af73e6c}{MPIdim}[2] - 1) \{
513       \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(2, 1);
514       HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, values);
515     \}
516 
517     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a8220294108e39b58632993a50a7dc4ca}{MPIcoords}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}][0] == 0) \{
518       \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} nvalues;
519       nvalues = \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
520       \textcolor{keywordflow}{for} (i = 0; i < nvalues; i++)
521         values[i] = z * \hyperlink{fields_8h_a80c6ee80e0f056adba2430ab0d21e58f}{fieldBC}[\hyperlink{fields_8h_a10bed19ceedeb2c12c5aad6de1d3b1a1}{TEMP}];
522       \hyperlink{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{tempSetBoundary}(0, -1);
523       HYPRE\_SStructVectorAddToBoxValues(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b}, 0, \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}, \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}, 0, values);
524     \}
525     free(values);
526 
527     HYPRE\_SStructVectorAssemble(\hyperlink{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{b});
528     HYPRE\_SStructVectorAssemble(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x});
529 
530   \}
531 
532   HYPRE\_ParCSRPCGSolve(\hyperlink{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{tempSolver}, \hyperlink{tempf_8c_af2d53284d0549b262215b77eb3fc5cad}{parA}, \hyperlink{tempf_8c_a22c8c44999d3430aef3e02c8081b9d9e}{parb}, \hyperlink{tempf_8c_a2a202d5a6f9421afac04dc63cc35ce6f}{parx});
533 
534   \textcolor{comment}{/* copy solution to field buffer */}
535   HYPRE\_SStructVectorGather(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x});
536   values = calloc(nvalues, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
537   HYPRE\_SStructVectorGetBoxValues(\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}, 0, \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}, \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}, 0, values);
538   idx = 0;
539   \textcolor{keywordflow}{for} (k = 0; k < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k++)
540     \textcolor{keywordflow}{for} (j = 0; j < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
541       \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++, idx++)
542         \hyperlink{fields_8h_afffa6ff788240a58e074a58603f3d11e}{tempField}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * i + 
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * j + k] =
543           values[idx];
544   free(values);
545 
546   \hyperlink{tempf_8c_a99cc2555bf46405acb3e2b14e8567604}{tempIter}++;
547   \textcolor{comment}{/* stdout brought back */}
548   \hyperlink{io_8c_affa00173da9bea48973a6ac887d505bb}{revertStdOut}();
549 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=292pt]{tempf_8c_a7e47d73682b9a931fd9d680f6d495331_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tempf_8c_a7e47d73682b9a931fd9d680f6d495331_icgraph}
\end{center}
\end{figure}


\hypertarget{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}{\index{tempf.\-c@{tempf.\-c}!temp\-Set\-Boundary@{temp\-Set\-Boundary}}
\index{temp\-Set\-Boundary@{temp\-Set\-Boundary}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Set\-Boundary}]{\setlength{\rightskip}{0pt plus 5cm}void temp\-Set\-Boundary (
\begin{DoxyParamCaption}
\item[{int}]{coord, }
\item[{int}]{boundary}
\end{DoxyParamCaption}
)}}\label{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69}
This function sets boundary conditions for domain faces. 

Definition at line 71 of file tempf.\-c.



References bc\-Lower, bc\-Upper, temp\-Lower, and temp\-Upper.


\begin{DoxyCode}
72 \{
73   \textcolor{keywordflow}{if} (coord == 0 && boundary == -1) \{
74     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[0] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0];
75     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[0] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0];
76     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[1] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1];
77     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[1] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1];
78     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[2] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2];
79     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[2] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2];
80   \}
81   \textcolor{keywordflow}{if} (coord == 0 && boundary == 1) \{
82     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[0] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0];
83     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[0] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0];
84     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[1] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1];
85     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[1] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1];
86     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[2] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2];
87     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[2] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2];
88   \}
89   \textcolor{keywordflow}{if} (coord == 1 && boundary == -1) \{
90     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[0] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0];
91     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[0] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0];
92     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[1] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1];
93     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[1] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1];
94     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[2] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2];
95     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[2] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2];
96   \}
97   \textcolor{keywordflow}{if} (coord == 1 && boundary == 1) \{
98     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[0] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0];
99     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[0] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0];
100     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[1] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1];
101     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[1] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1];
102     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[2] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2];
103     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[2] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2];
104   \}
105   \textcolor{keywordflow}{if} (coord == 2 && boundary == -1) \{
106     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[0] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0];
107     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[0] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0];
108     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[1] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1];
109     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[1] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1];
110     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[2] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2];
111     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[2] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[2];
112   \}
113   \textcolor{keywordflow}{if} (coord == 2 && boundary == 1) \{
114     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[0] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[0];
115     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[0] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[0];
116     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[1] = \hyperlink{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{tempLower}[1];
117     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[1] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[1];
118     \hyperlink{tempf_8c_a397798166a570960b5d468b6df8bf02c}{bcLower}[2] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2];
119     \hyperlink{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{bcUpper}[2] = \hyperlink{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{tempUpper}[2];
120   \}
121 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tempf_8c_a79074c63a5e46e7e5ae6648324ed3c69_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}{\index{tempf.\-c@{tempf.\-c}!A@{A}}
\index{A@{A}!tempf.c@{tempf.\-c}}
\subsubsection[{A}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Matrix A}}\label{tempf_8c_a1452a7f843e91ac3a1c29b82092d467c}


Definition at line 39 of file tempf.\-c.

\hypertarget{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}{\index{tempf.\-c@{tempf.\-c}!b@{b}}
\index{b@{b}!tempf.c@{tempf.\-c}}
\subsubsection[{b}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Vector b}}\label{tempf_8c_a74a523afdfebddf9b6b280e545977c5a}


Definition at line 40 of file tempf.\-c.

\hypertarget{tempf_8c_a397798166a570960b5d468b6df8bf02c}{\index{tempf.\-c@{tempf.\-c}!bc\-Lower@{bc\-Lower}}
\index{bc\-Lower@{bc\-Lower}!tempf.c@{tempf.\-c}}
\subsubsection[{bc\-Lower}]{\setlength{\rightskip}{0pt plus 5cm}long long bc\-Lower\mbox{[}3\mbox{]}}}\label{tempf_8c_a397798166a570960b5d468b6df8bf02c}


Definition at line 53 of file tempf.\-c.

\hypertarget{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}{\index{tempf.\-c@{tempf.\-c}!bc\-Upper@{bc\-Upper}}
\index{bc\-Upper@{bc\-Upper}!tempf.c@{tempf.\-c}}
\subsubsection[{bc\-Upper}]{\setlength{\rightskip}{0pt plus 5cm}long long bc\-Upper\mbox{[}3\mbox{]}}}\label{tempf_8c_aaea99b8c85fcedb15091dcac991999fd}


Definition at line 54 of file tempf.\-c.

\hypertarget{tempf_8c_a03e28be41881b703c836edbfe9b51b17}{\index{tempf.\-c@{tempf.\-c}!dt@{dt}}
\index{dt@{dt}!tempf.c@{tempf.\-c}}
\subsubsection[{dt}]{\setlength{\rightskip}{0pt plus 5cm}double dt}}\label{tempf_8c_a03e28be41881b703c836edbfe9b51b17}


Definition at line 56 of file tempf.\-c.

\hypertarget{tempf_8c_af2d53284d0549b262215b77eb3fc5cad}{\index{tempf.\-c@{tempf.\-c}!par\-A@{par\-A}}
\index{par\-A@{par\-A}!tempf.c@{tempf.\-c}}
\subsubsection[{par\-A}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-Par\-C\-S\-R\-Matrix par\-A}}\label{tempf_8c_af2d53284d0549b262215b77eb3fc5cad}


Definition at line 43 of file tempf.\-c.

\hypertarget{tempf_8c_a22c8c44999d3430aef3e02c8081b9d9e}{\index{tempf.\-c@{tempf.\-c}!parb@{parb}}
\index{parb@{parb}!tempf.c@{tempf.\-c}}
\subsubsection[{parb}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-Par\-Vector parb}}\label{tempf_8c_a22c8c44999d3430aef3e02c8081b9d9e}


Definition at line 44 of file tempf.\-c.

\hypertarget{tempf_8c_a2a202d5a6f9421afac04dc63cc35ce6f}{\index{tempf.\-c@{tempf.\-c}!parx@{parx}}
\index{parx@{parx}!tempf.c@{tempf.\-c}}
\subsubsection[{parx}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-Par\-Vector parx}}\label{tempf_8c_a2a202d5a6f9421afac04dc63cc35ce6f}


Definition at line 45 of file tempf.\-c.

\hypertarget{tempf_8c_a8e4efbbc574194c74f201b9328263d51}{\index{tempf.\-c@{tempf.\-c}!temp\-Graph@{temp\-Graph}}
\index{temp\-Graph@{temp\-Graph}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Graph}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Graph temp\-Graph}}\label{tempf_8c_a8e4efbbc574194c74f201b9328263d51}


Definition at line 36 of file tempf.\-c.

\hypertarget{tempf_8c_a306941a728f83331c95c2355cbad756e}{\index{tempf.\-c@{tempf.\-c}!temp\-Grid@{temp\-Grid}}
\index{temp\-Grid@{temp\-Grid}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Grid}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Grid temp\-Grid}}\label{tempf_8c_a306941a728f83331c95c2355cbad756e}


Definition at line 35 of file tempf.\-c.

\hypertarget{tempf_8c_a99cc2555bf46405acb3e2b14e8567604}{\index{tempf.\-c@{tempf.\-c}!temp\-Iter@{temp\-Iter}}
\index{temp\-Iter@{temp\-Iter}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Iter}]{\setlength{\rightskip}{0pt plus 5cm}int temp\-Iter}}\label{tempf_8c_a99cc2555bf46405acb3e2b14e8567604}


Definition at line 64 of file tempf.\-c.

\hypertarget{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}{\index{tempf.\-c@{tempf.\-c}!temp\-Lambda@{temp\-Lambda}}
\index{temp\-Lambda@{temp\-Lambda}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Lambda}]{\setlength{\rightskip}{0pt plus 5cm}double temp\-Lambda = 0.\-25}}\label{tempf_8c_abac9e0ed06bb0a5fea5332d7c39f0b8e}


Definition at line 57 of file tempf.\-c.

\hypertarget{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}{\index{tempf.\-c@{tempf.\-c}!temp\-Lower@{temp\-Lower}}
\index{temp\-Lower@{temp\-Lower}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Lower}]{\setlength{\rightskip}{0pt plus 5cm}long long temp\-Lower\mbox{[}3\mbox{]}}}\label{tempf_8c_a196355f9f84bb71de2c7f2817d245e20}


Definition at line 52 of file tempf.\-c.

\hypertarget{tempf_8c_a5d7b5d2a5e1ad21ae8f4bd43f0392276}{\index{tempf.\-c@{tempf.\-c}!temp\-N\-Parts@{temp\-N\-Parts}}
\index{temp\-N\-Parts@{temp\-N\-Parts}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-N\-Parts}]{\setlength{\rightskip}{0pt plus 5cm}int temp\-N\-Parts}}\label{tempf_8c_a5d7b5d2a5e1ad21ae8f4bd43f0392276}


Definition at line 62 of file tempf.\-c.

\hypertarget{tempf_8c_a61d9e9d52407e9c24553063b99088457}{\index{tempf.\-c@{tempf.\-c}!temp\-N\-Vars@{temp\-N\-Vars}}
\index{temp\-N\-Vars@{temp\-N\-Vars}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-N\-Vars}]{\setlength{\rightskip}{0pt plus 5cm}int temp\-N\-Vars}}\label{tempf_8c_a61d9e9d52407e9c24553063b99088457}


Definition at line 61 of file tempf.\-c.

\hypertarget{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}{\index{tempf.\-c@{tempf.\-c}!temp\-Object\-Type@{temp\-Object\-Type}}
\index{temp\-Object\-Type@{temp\-Object\-Type}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Object\-Type}]{\setlength{\rightskip}{0pt plus 5cm}int temp\-Object\-Type}}\label{tempf_8c_a3b7e11fcbb7f9521ac3f553e1a0e292d}


Definition at line 50 of file tempf.\-c.

\hypertarget{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}{\index{tempf.\-c@{tempf.\-c}!temp\-Precond@{temp\-Precond}}
\index{temp\-Precond@{temp\-Precond}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Precond}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-Solver temp\-Precond}}\label{tempf_8c_a0b22e7791e7e1c5dc3e0f61e9a6149eb}


Definition at line 48 of file tempf.\-c.

\hypertarget{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}{\index{tempf.\-c@{tempf.\-c}!temp\-Solver@{temp\-Solver}}
\index{temp\-Solver@{temp\-Solver}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Solver}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-Solver temp\-Solver}}\label{tempf_8c_a7d3217679c2aa0229a38f279a62863d7}


Definition at line 47 of file tempf.\-c.

\hypertarget{tempf_8c_a8e2e31e96bb8622f2b457c7a631b0b17}{\index{tempf.\-c@{tempf.\-c}!temp\-Stencil@{temp\-Stencil}}
\index{temp\-Stencil@{temp\-Stencil}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Stencil}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Stencil temp\-Stencil}}\label{tempf_8c_a8e2e31e96bb8622f2b457c7a631b0b17}


Definition at line 37 of file tempf.\-c.

\hypertarget{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}{\index{tempf.\-c@{tempf.\-c}!temp\-Upper@{temp\-Upper}}
\index{temp\-Upper@{temp\-Upper}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Upper}]{\setlength{\rightskip}{0pt plus 5cm}long long temp\-Upper\mbox{[}3\mbox{]}}}\label{tempf_8c_ad0a57dc1002e63ea4c360662e6019ef3}


Definition at line 52 of file tempf.\-c.

\hypertarget{tempf_8c_a10ce94c724b037f8ef4c4d6c9bcbbb94}{\index{tempf.\-c@{tempf.\-c}!temp\-Vartypes@{temp\-Vartypes}}
\index{temp\-Vartypes@{temp\-Vartypes}!tempf.c@{tempf.\-c}}
\subsubsection[{temp\-Vartypes}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Variable temp\-Vartypes\mbox{[}1\mbox{]} = \{ H\-Y\-P\-R\-E\-\_\-\-S\-S\-T\-R\-U\-C\-T\-\_\-\-V\-A\-R\-I\-A\-B\-L\-E\-\_\-\-N\-O\-D\-E \}}}\label{tempf_8c_a10ce94c724b037f8ef4c4d6c9bcbbb94}


Definition at line 66 of file tempf.\-c.

\hypertarget{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}{\index{tempf.\-c@{tempf.\-c}!tfname@{tfname}}
\index{tfname@{tfname}!tempf.c@{tempf.\-c}}
\subsubsection[{tfname}]{\setlength{\rightskip}{0pt plus 5cm}char tfname\mbox{[}256\mbox{]}}}\label{tempf_8c_a2063913752083aa6b25d054e8d34dbc6}


Definition at line 59 of file tempf.\-c.

\hypertarget{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{\index{tempf.\-c@{tempf.\-c}!x@{x}}
\index{x@{x}!tempf.c@{tempf.\-c}}
\subsubsection[{x}]{\setlength{\rightskip}{0pt plus 5cm}H\-Y\-P\-R\-E\-\_\-\-S\-Struct\-Vector x}}\label{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}


Definition at line 41 of file tempf.\-c.

