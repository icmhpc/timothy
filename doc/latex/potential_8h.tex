\hypertarget{potential_8h}{\section{potential.\-h File Reference}
\label{potential_8h}\index{potential.\-h@{potential.\-h}}
}
This graph shows which files directly or indirectly include this file\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=140pt]{potential_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{global_8h_a6134d67e4df19bf6929a4c1322ae7f9b}{M\-I\-C\-\_\-\-A\-T\-T\-R} void \hyperlink{potential_8h_ac7aa3d6bad50d0aeec842c955c0a6fbc}{comp\-Pot} ()
\item 
\hyperlink{global_8h_a6134d67e4df19bf6929a4c1322ae7f9b}{M\-I\-C\-\_\-\-A\-T\-T\-R} void \hyperlink{potential_8h_abccd029519c0cc81a9dd6fa83c8c22d3}{comp\-R\-Pot} ()
\item 
\hyperlink{global_8h_a6134d67e4df19bf6929a4c1322ae7f9b}{M\-I\-C\-\_\-\-A\-T\-T\-R} void \hyperlink{potential_8h_a47f626f2b9ed30f1256ea1299104b80f}{comp\-Pot\-Grad} ()
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{potential_8h_ac7aa3d6bad50d0aeec842c955c0a6fbc}{\index{potential.\-h@{potential.\-h}!comp\-Pot@{comp\-Pot}}
\index{comp\-Pot@{comp\-Pot}!potential.h@{potential.\-h}}
\subsubsection[{comp\-Pot}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\-I\-C\-\_\-\-A\-T\-T\-R} void comp\-Pot (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{potential_8h_ac7aa3d6bad50d0aeec842c955c0a6fbc}
This function implements tree walk algorithm for each local cell. Function cc\-Pot(..) is called for each pair of neighbours. 

Definition at line 152 of file potential.\-c.



References cc\-Pot(), cells, \-\_\-oct\-Node\-::child, \-\_\-oct\-Node\-::data, cell\-Data\-::density, lnc, statistics\-Data\-::mindist, nx, oct\-Compute\-Box(), oct\-Heap\-Free(), oct\-Heap\-Init(), oct\-Heap\-Pop(), oct\-Heap\-Push(), oct\-Locate\-Region(), octree, s, statistics, tnc, and cell\-Data\-::v.


\begin{DoxyCode}
153 \{
154   \textcolor{keywordflow}{if}(\hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}<=1) \textcolor{keywordflow}{return};
155 \textcolor{preprocessor}{  #pragma omp parallel}
156 \textcolor{preprocessor}{}  \{
157     \textcolor{keywordtype}{int} p;
158     \textcolor{keywordtype}{double} mindist;
159     mindist=\hyperlink{global_8h_a5ff16f483e01fddca329425a21a8b219}{nx};
160 
161 \textcolor{preprocessor}{    #pragma omp for schedule(dynamic,64)}
162 \textcolor{preprocessor}{}    \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}; p++) \{
163       int64\_t cellIdx;
164       \textcolor{keywordtype}{int} newIdx;
165       \textcolor{keywordtype}{int} \hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s};
166       \textcolor{keywordtype}{int} octIndex;
167       \textcolor{keyword}{struct }\hyperlink{structuintVector3d}{uintVector3d} minLocCode,maxLocCode;
168       \hyperlink{struct__octHeap}{octHeap} octh;
169       \hyperlink{octree_8c_a95956477641a199cf4e32e2677cfa0c1}{octHeapInit}(&octh);
170 
171       \hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[p].\hyperlink{structcellData_a6f8c052f8417728038991f7f2826d38d}{density} = 0.0;
172       \hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[p].\hyperlink{structcellData_a3b90d5a73541ab9402511d87bed076ef}{v} = 0.0;
173 
174       \hyperlink{octree_8c_a282cb66db7aebdecf7a63a39ab410f43}{octComputeBox}(p,&minLocCode,&maxLocCode);
175       octIndex=\hyperlink{octree_8c_ad868a4549e255fff18ccb3a00c541cba}{octLocateRegion}(minLocCode,maxLocCode);
176 
177       \textcolor{keywordflow}{for}(s=0; s<\hyperlink{global_8h_ace8c09599079e718c7fb9fc6ab9b0726}{tnc}; s++) \{
178         \textcolor{keywordtype}{int} idx;
179         idx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[octIndex].\hyperlink{struct__octNode_a436082644033f00fa1dd628aee81b270}{child}[\hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s}];
180         \textcolor{keywordflow}{if}(idx!=-1 && octNodeIntersection(idx,minLocCode,maxLocCode))
181           \hyperlink{octree_8c_a55bad651d51d5fd7c085f9dde6eedde9}{octHeapPush}(&octh,idx);
182       \}
183 
184       \textcolor{keywordflow}{while}(octh.count>0) \{
185         \textcolor{keywordtype}{int} idx;
186         idx=\hyperlink{octree_8c_aa13995841341f9f38845b72b57330047}{octHeapPop}(&octh);
187         cellIdx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[idx].\hyperlink{struct__octNode_a9eab91667db4d35c7231dcddf7b89a76}{data};
188         \textcolor{keywordflow}{if}(cellIdx>=0) \{
189           \hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[p].\hyperlink{structcellData_a3b90d5a73541ab9402511d87bed076ef}{v} += \hyperlink{potential_8c_afc372ff09291715cb67dc2c107581c9b}{ccPot}(p,cellIdx,0,&mindist);
190         \} \textcolor{keywordflow}{else} \{
191           \textcolor{keywordflow}{for}(s=0; s<\hyperlink{global_8h_ace8c09599079e718c7fb9fc6ab9b0726}{tnc}; s++) \{
192             newIdx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[idx].\hyperlink{struct__octNode_a436082644033f00fa1dd628aee81b270}{child}[\hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s}];
193             \textcolor{keywordflow}{if}(newIdx!=-1 && octNodeIntersection(newIdx,minLocCode,maxLocCode))
194               \hyperlink{octree_8c_a55bad651d51d5fd7c085f9dde6eedde9}{octHeapPush}(&octh,newIdx);
195           \}
196         \}
197       \}
198       \hyperlink{octree_8c_a9c16add0aabe4446e59c7d5e0bef41af}{octHeapFree}(&octh);
199     \}
200 \textcolor{preprocessor}{    #pragma omp critical}
201 \textcolor{preprocessor}{}    \hyperlink{global_8h_aa28392f90ce59a6b79b9b939fd364a9a}{statistics}.\hyperlink{structstatisticsData_a78455d23ec97258967b76cbb2332b7be}{mindist}=(\hyperlink{global_8h_aa28392f90ce59a6b79b9b939fd364a9a}{statistics}.\hyperlink{structstatisticsData_a78455d23ec97258967b76cbb2332b7be}{mindist}>mindist?mindist:
      \hyperlink{global_8h_aa28392f90ce59a6b79b9b939fd364a9a}{statistics}.\hyperlink{structstatisticsData_a78455d23ec97258967b76cbb2332b7be}{mindist});
202   \}
203 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{potential_8h_ac7aa3d6bad50d0aeec842c955c0a6fbc_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{potential_8h_ac7aa3d6bad50d0aeec842c955c0a6fbc_icgraph}
\end{center}
\end{figure}


\hypertarget{potential_8h_a47f626f2b9ed30f1256ea1299104b80f}{\index{potential.\-h@{potential.\-h}!comp\-Pot\-Grad@{comp\-Pot\-Grad}}
\index{comp\-Pot\-Grad@{comp\-Pot\-Grad}!potential.h@{potential.\-h}}
\subsubsection[{comp\-Pot\-Grad}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\-I\-C\-\_\-\-A\-T\-T\-R} void comp\-Pot\-Grad (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{potential_8h_a47f626f2b9ed30f1256ea1299104b80f}
This function implements tree walk algorithm for each local cell to compute potential gradient. Function cc\-Pot\-Grad(..) is called for each pair of neighbours. 

Definition at line 334 of file potential.\-c.



References cc\-Pot\-Grad(), \-\_\-oct\-Node\-::child, \-\_\-oct\-Node\-::data, lnc, oct\-Compute\-Box(), oct\-Heap\-Free(), oct\-Heap\-Init(), oct\-Heap\-Pop(), oct\-Heap\-Push(), oct\-Locate\-Region(), octree, s, tnc, velocity, double\-Vector3d\-::x, double\-Vector3d\-::y, and double\-Vector3d\-::z.


\begin{DoxyCode}
335 \{
336   \textcolor{keywordtype}{int} p;
337   \textcolor{keywordflow}{if}(\hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}<=1) \textcolor{keywordflow}{return};
338 \textcolor{preprocessor}{  #pragma omp parallel for schedule(dynamic,64)}
339 \textcolor{preprocessor}{}  \textcolor{keywordflow}{for}(p=0; p<\hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}; p++) \{
340     int64\_t cellIdx;
341     \textcolor{keywordtype}{int} newIdx;
342     \textcolor{keywordtype}{int} \hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s};
343     \textcolor{keywordtype}{int} octIndex;
344     \textcolor{keyword}{struct }\hyperlink{structuintVector3d}{uintVector3d} minLocCode,maxLocCode;
345     \hyperlink{struct__octHeap}{octHeap} octh;
346 
347     \hyperlink{octree_8c_a95956477641a199cf4e32e2677cfa0c1}{octHeapInit}(&octh);
348     \hyperlink{global_8h_a5ccb3d82df0a6670a0dee2ccd768c0dd}{velocity}[p].\hyperlink{structdoubleVector3d_af88b946fb90d5f08b5fb740c70e98c10}{x}=0.0;
349     \hyperlink{global_8h_a5ccb3d82df0a6670a0dee2ccd768c0dd}{velocity}[p].\hyperlink{structdoubleVector3d_ab927965981178aa1fba979a37168db2a}{y}=0.0;
350     \hyperlink{global_8h_a5ccb3d82df0a6670a0dee2ccd768c0dd}{velocity}[p].\hyperlink{structdoubleVector3d_ab3e6ed577a7c669c19de1f9c1b46c872}{z}=0.0;
351 
352     \hyperlink{octree_8c_a282cb66db7aebdecf7a63a39ab410f43}{octComputeBox}(p,&minLocCode,&maxLocCode);
353     octIndex=\hyperlink{octree_8c_ad868a4549e255fff18ccb3a00c541cba}{octLocateRegion}(minLocCode,maxLocCode);
354 
355     \textcolor{keywordflow}{for}(s=0; s<\hyperlink{global_8h_ace8c09599079e718c7fb9fc6ab9b0726}{tnc}; s++) \{
356       \textcolor{keywordtype}{int} idx;
357       idx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[octIndex].\hyperlink{struct__octNode_a436082644033f00fa1dd628aee81b270}{child}[\hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s}];
358       \textcolor{keywordflow}{if}(idx!=-1 && octNodeIntersection(idx,minLocCode,maxLocCode))
359         \hyperlink{octree_8c_a55bad651d51d5fd7c085f9dde6eedde9}{octHeapPush}(&octh,idx);
360     \}
361 
362     \textcolor{keywordflow}{while}(octh.count>0) \{
363       \textcolor{keywordtype}{int} idx;
364       idx=\hyperlink{octree_8c_aa13995841341f9f38845b72b57330047}{octHeapPop}(&octh);
365       cellIdx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[idx].\hyperlink{struct__octNode_a9eab91667db4d35c7231dcddf7b89a76}{data};
366       \textcolor{keywordflow}{if}(cellIdx>=0) \{
367         \hyperlink{potential_8c_aae47c5f13dfa21cb56b8b7868b1fc9b3}{ccPotGrad}(p,cellIdx,0);
368       \} \textcolor{keywordflow}{else} \{
369         \textcolor{keywordflow}{for}(s=0; s<\hyperlink{global_8h_ace8c09599079e718c7fb9fc6ab9b0726}{tnc}; s++) \{
370           newIdx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[idx].\hyperlink{struct__octNode_a436082644033f00fa1dd628aee81b270}{child}[\hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s}];
371           \textcolor{keywordflow}{if}(newIdx!=-1 && octNodeIntersection(newIdx,minLocCode,maxLocCode))
372             \hyperlink{octree_8c_a55bad651d51d5fd7c085f9dde6eedde9}{octHeapPush}(&octh,newIdx);
373         \}
374       \}
375     \}
376     \hyperlink{octree_8c_a9c16add0aabe4446e59c7d5e0bef41af}{octHeapFree}(&octh);
377   \}
378 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{potential_8h_a47f626f2b9ed30f1256ea1299104b80f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{potential_8h_a47f626f2b9ed30f1256ea1299104b80f_icgraph}
\end{center}
\end{figure}


\hypertarget{potential_8h_abccd029519c0cc81a9dd6fa83c8c22d3}{\index{potential.\-h@{potential.\-h}!comp\-R\-Pot@{comp\-R\-Pot}}
\index{comp\-R\-Pot@{comp\-R\-Pot}!potential.h@{potential.\-h}}
\subsubsection[{comp\-R\-Pot}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\-I\-C\-\_\-\-A\-T\-T\-R} void comp\-R\-Pot (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{potential_8h_abccd029519c0cc81a9dd6fa83c8c22d3}
This function implements tree walk algorithm for each remote cell. Function cc\-Pot(..) is called for each pair of neighbours. 

Definition at line 209 of file potential.\-c.



References cc\-Pot(), cells, \-\_\-oct\-Node\-::child, \-\_\-oct\-Node\-::data, statistics\-Data\-::mindist, num\-Imp, nx, oct\-Compute\-Box\-R(), oct\-Heap\-Free(), oct\-Heap\-Init(), oct\-Heap\-Pop(), oct\-Heap\-Push(), octree, s, statistics, tnc, cell\-Data\-::v, and v.


\begin{DoxyCode}
210 \{
211   \textcolor{keywordtype}{int} rp;
212   \textcolor{keywordflow}{if}(\hyperlink{global_8h_a07792d8e2788e030124304f47e8cf1f6}{numImp}<=0) \textcolor{keywordflow}{return};
213 \textcolor{preprocessor}{  #pragma omp parallel}
214 \textcolor{preprocessor}{}  \{
215     \textcolor{keywordtype}{double} mindist;
216     mindist=\hyperlink{global_8h_a5ff16f483e01fddca329425a21a8b219}{nx};
217 \textcolor{preprocessor}{    #pragma omp for schedule(dynamic,64)}
218 \textcolor{preprocessor}{}    \textcolor{keywordflow}{for} (rp = 0; rp < \hyperlink{global_8h_a07792d8e2788e030124304f47e8cf1f6}{numImp}; rp++) \{
219       int64\_t cellIdx;
220       \textcolor{keywordtype}{int} newIdx;
221       \textcolor{keywordtype}{int} \hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s};
222       \textcolor{keywordtype}{double} \hyperlink{global_8h_a48d9522e58fa05906c6dba23e5745a72}{v};
223       \textcolor{keyword}{struct }\hyperlink{structuintVector3d}{uintVector3d} minLocCode,maxLocCode;
224       \hyperlink{struct__octHeap}{octHeap} octh;
225       \hyperlink{octree_8c_a95956477641a199cf4e32e2677cfa0c1}{octHeapInit}(&octh);
226       \hyperlink{octree_8c_a2b9b682e42d53652d70046be6ba37da0}{octComputeBoxR}(rp,&minLocCode,&maxLocCode);
227       \hyperlink{octree_8c_a55bad651d51d5fd7c085f9dde6eedde9}{octHeapPush}(&octh,0);
228       \textcolor{keywordflow}{while}(octh.count>0) \{
229         \textcolor{keywordtype}{int} idx;
230         idx=\hyperlink{octree_8c_aa13995841341f9f38845b72b57330047}{octHeapPop}(&octh);
231         cellIdx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[idx].\hyperlink{struct__octNode_a9eab91667db4d35c7231dcddf7b89a76}{data};
232         \textcolor{keywordflow}{if}(cellIdx>=0) \{
233           v=\hyperlink{potential_8c_afc372ff09291715cb67dc2c107581c9b}{ccPot}(rp,cellIdx,1,&mindist);
234 \textcolor{preprocessor}{          #pragma omp atomic}
235 \textcolor{preprocessor}{}          \hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[cellIdx].\hyperlink{structcellData_a3b90d5a73541ab9402511d87bed076ef}{v} += \hyperlink{global_8h_a48d9522e58fa05906c6dba23e5745a72}{v};
236         \} \textcolor{keywordflow}{else} \{
237           \textcolor{keywordflow}{for}(s=0; s<\hyperlink{global_8h_ace8c09599079e718c7fb9fc6ab9b0726}{tnc}; s++) \{
238             newIdx=\hyperlink{global_8h_a3bfee3c99da0683981b8c1828598dfd7}{octree}[idx].\hyperlink{struct__octNode_a436082644033f00fa1dd628aee81b270}{child}[\hyperlink{global_8h_a874f74a4dc1c9a0cd9c6e0d79c298f55}{s}];
239             \textcolor{keywordflow}{if}(newIdx!=-1 && octNodeIntersection(newIdx,minLocCode,maxLocCode))
240               \hyperlink{octree_8c_a55bad651d51d5fd7c085f9dde6eedde9}{octHeapPush}(&octh,newIdx);
241           \}
242         \}
243       \}
244       \hyperlink{octree_8c_a9c16add0aabe4446e59c7d5e0bef41af}{octHeapFree}(&octh);
245     \}
246 \textcolor{preprocessor}{    #pragma omp critical}
247 \textcolor{preprocessor}{}    \hyperlink{global_8h_aa28392f90ce59a6b79b9b939fd364a9a}{statistics}.\hyperlink{structstatisticsData_a78455d23ec97258967b76cbb2332b7be}{mindist}=(\hyperlink{global_8h_aa28392f90ce59a6b79b9b939fd364a9a}{statistics}.\hyperlink{structstatisticsData_a78455d23ec97258967b76cbb2332b7be}{mindist}>mindist?mindist:
      \hyperlink{global_8h_aa28392f90ce59a6b79b9b939fd364a9a}{statistics}.\hyperlink{structstatisticsData_a78455d23ec97258967b76cbb2332b7be}{mindist});
248   \}
249 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{potential_8h_abccd029519c0cc81a9dd6fa83c8c22d3_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{potential_8h_abccd029519c0cc81a9dd6fa83c8c22d3_icgraph}
\end{center}
\end{figure}


