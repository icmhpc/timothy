\hypertarget{interp_8c}{\section{interp.\-c File Reference}
\label{interp_8c}\index{interp.\-c@{interp.\-c}}
}


contains grid to cellular data interpolation functions  


{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include $<$limits.\-h$>$}\\*
{\ttfamily \#include \char`\"{}global.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fields.\-h\char`\"{}}\\*
Include dependency graph for interp.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{interp_8c_a0817af402f7cf7ac0309520dbcd5b71d}{patch}(p, f, i, j, k)~(\hyperlink{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}{cic\-Patch}\mbox{[}p\mbox{]}\mbox{[}\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patch\-Size}\mbox{[}p\mbox{]}.\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}$\ast$\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patch\-Size}\mbox{[}p\mbox{]}.y$\ast$\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patch\-Size}\mbox{[}p\mbox{]}.z$\ast$f+\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patch\-Size}\mbox{[}p\mbox{]}.y$\ast$\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patch\-Size}\mbox{[}p\mbox{]}.z$\ast$i+\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patch\-Size}\mbox{[}p\mbox{]}.z$\ast$j+k\mbox{]})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{interp_8c_a4299a7e9993adbe7a047b835b2339550}{find\-Patches} ()
\item 
void \hyperlink{interp_8c_a09ed91c5c40f3937e10c8c60c2b8fb7f}{do\-Interpolation} ()
\item 
void \hyperlink{interp_8c_a085ef29ed8159779989ae8fac05fd699}{init\-Patch\-Exchange} ()
\item 
int \hyperlink{interp_8c_a4124511b40767952ed61d5ae30bae7b6}{wait\-Patch\-Exchange} ()
\item 
int \hyperlink{interp_8c_a3e968c18c11bbe46df754e7eca593b33}{apply\-Patches} ()
\item 
void \hyperlink{interp_8c_a4fe8eca69017d7e0f87fd2c6cdb9b2e2}{init\-Fields\-Patches\-Exchange} ()
\item 
void \hyperlink{interp_8c_a751d539b1af7ca1f9ce8e55a91084874}{wait\-Fields\-Patches\-Exchange} ()
\item 
void \hyperlink{interp_8c_a08111192411fead96613d994aa95f960}{apply\-Fields\-Patches} ()
\item 
void \hyperlink{interp_8c_ace868928ce5497cc3edc942bd5c8f396}{interpolate\-Cells\-To\-Grid} ()
\item 
void \hyperlink{interp_8c_ad862fb7e08b1dee6d784a09a26978ada}{init\-Cells\-To\-Grid\-Exchange} ()
\item 
void \hyperlink{interp_8c_ac7fd669461f281bbaceac377028fb722}{wait\-Cells\-To\-Grid\-Exchange} ()
\item 
void \hyperlink{interp_8c_a7f8b42e40580516283e6f43ce7fe6389}{interpolate\-Fields\-To\-Cells} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double $\ast$$\ast$ \hyperlink{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}{cic\-Patch}
\item 
int $\ast$ \hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cic\-Intersect}
\item 
int $\ast$ \hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cic\-Receiver}
\item 
int $\ast$ \hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cic\-Sender}
\item 
double $\ast$$\ast$ \hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cic\-Recv\-Patch}
\item 
M\-P\-I\-\_\-\-Request $\ast$ \hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cic\-Req\-Send}
\item 
M\-P\-I\-\_\-\-Request $\ast$ \hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cic\-Req\-Recv}
\item 
int $\ast$ \hyperlink{interp_8c_a55ace146e560886795409d6ac149119c}{recv\-P}
\item 
struct \hyperlink{structint64Vector3d}{int64\-Vector3d} $\ast$ \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lower\-Patch\-Corner}
\item 
struct \hyperlink{structint64Vector3d}{int64\-Vector3d} $\ast$ \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upper\-Patch\-Corner}
\item 
struct \hyperlink{structint64Vector3d}{int64\-Vector3d} $\ast$ \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lower\-Patch\-Corner\-R}
\item 
struct \hyperlink{structint64Vector3d}{int64\-Vector3d} $\ast$ \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upper\-Patch\-Corner\-R}
\item 
struct \hyperlink{structint64Vector3d}{int64\-Vector3d} $\ast$ \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patch\-Size}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
contains grid to cellular data interpolation functions 

Definition in file \hyperlink{interp_8c_source}{interp.\-c}.



\subsection{Macro Definition Documentation}
\hypertarget{interp_8c_a0817af402f7cf7ac0309520dbcd5b71d}{\index{interp.\-c@{interp.\-c}!patch@{patch}}
\index{patch@{patch}!interp.c@{interp.\-c}}
\subsubsection[{patch}]{\setlength{\rightskip}{0pt plus 5cm}\#define patch(
\begin{DoxyParamCaption}
\item[{}]{p, }
\item[{}]{f, }
\item[{}]{i, }
\item[{}]{j, }
\item[{}]{k}
\end{DoxyParamCaption}
)~({\bf cic\-Patch}\mbox{[}p\mbox{]}\mbox{[}{\bf patch\-Size}\mbox{[}p\mbox{]}.{\bf x}$\ast${\bf patch\-Size}\mbox{[}p\mbox{]}.y$\ast${\bf patch\-Size}\mbox{[}p\mbox{]}.z$\ast$f+{\bf patch\-Size}\mbox{[}p\mbox{]}.y$\ast${\bf patch\-Size}\mbox{[}p\mbox{]}.z$\ast$i+{\bf patch\-Size}\mbox{[}p\mbox{]}.z$\ast$j+k\mbox{]})}}\label{interp_8c_a0817af402f7cf7ac0309520dbcd5b71d}


Definition at line 49 of file interp.\-c.



\subsection{Function Documentation}
\hypertarget{interp_8c_a08111192411fead96613d994aa95f960}{\index{interp.\-c@{interp.\-c}!apply\-Fields\-Patches@{apply\-Fields\-Patches}}
\index{apply\-Fields\-Patches@{apply\-Fields\-Patches}!interp.c@{interp.\-c}}
\subsubsection[{apply\-Fields\-Patches}]{\setlength{\rightskip}{0pt plus 5cm}void apply\-Fields\-Patches (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a08111192411fead96613d994aa95f960}
Update local cell fields with information from remote processes received in patches. Receiveing field patches are deallocated here. 

Definition at line 561 of file interp.\-c.



References cell\-Fields, cells, cic\-Receiver, fields\-Patches, grid\-End\-Idx, grid\-Resolution, grid\-Start\-Idx, lnc, M\-P\-Isize, N\-C\-H\-E\-M, N\-F\-I\-E\-L\-D\-S, x, cell\-Data\-::x, double\-Vector3d\-::x, int64\-Vector3d\-::x, cell\-Data\-::y, double\-Vector3d\-::y, int64\-Vector3d\-::y, cell\-Data\-::z, double\-Vector3d\-::z, and int64\-Vector3d\-::z.


\begin{DoxyCode}
562 \{
563 
564   \textcolor{keywordtype}{int} p,c,f;
565   \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} idx;
566   \textcolor{keyword}{struct }\hyperlink{structdoubleVector3d}{doubleVector3d} d, t;
567   \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} cellIdx;
568   \textcolor{keyword}{struct }\hyperlink{structdoubleVector3d}{doubleVector3d} cicCoord;
569 
570   \textcolor{comment}{/* reset fields */}
571   \textcolor{keywordflow}{for} (f = 0; f < \hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}+\hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}*3; f++)
572     \textcolor{keywordflow}{for} (c = 0; c < \hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}; c++)
573       \hyperlink{global_8h_a25e4317a1b5bb95a8e71e0e8c4e11f2b}{cellFields}[f][c] = 0.0;
574 
575   \textcolor{keywordflow}{for} (c = 0; c < \hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}; c++) \{    \textcolor{comment}{/* for every cell */}
576     cellIdx.x = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_af88b946fb90d5f08b5fb740c70e98c10}{x} - lowerGridCorner.x) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
577     cellIdx.y = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab927965981178aa1fba979a37168db2a}{y} - lowerGridCorner.y) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
578     cellIdx.z = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab3e6ed577a7c669c19de1f9c1b46c872}{z} - lowerGridCorner.z) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
579     \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{  \textcolor{comment}{/* for each process */}
580       \textcolor{keywordtype}{int} ax, ay, az;
581       \textcolor{keywordflow}{if} (!\hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver}[p])
582         \textcolor{keywordflow}{continue};       \textcolor{comment}{/* there is no patch from this process */}
583       \textcolor{keywordflow}{for} (ax = 0; ax < 2; ax++)
584         \textcolor{keywordflow}{for} (ay = 0; ay < 2; ay++)
585           \textcolor{keywordflow}{for} (az = 0; az < 2; az++) \{
586             \textcolor{keywordflow}{if} (cellIdx.x + ax >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}
587                 && cellIdx.y + ay >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}
588                 && cellIdx.z + az >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}
589                 && cellIdx.x + ax <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}
590                 && cellIdx.y + ay <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}
591                 && cellIdx.z + az <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}) \{
592 
593               idx.x = (cellIdx.x + ax) - \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x};
594               idx.y = (cellIdx.y + ay) - \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structdoubleVector3d_ab927965981178aa1fba979a37168db2a}{y};
595               idx.z = (cellIdx.z + az) - \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structdoubleVector3d_ab3e6ed577a7c669c19de1f9c1b46c872}{z};
596 
597               cicCoord.x = lowerGridCorner.x + cellIdx.x * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
598               cicCoord.y = lowerGridCorner.y + cellIdx.y * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
599               cicCoord.z = lowerGridCorner.z + cellIdx.z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
600 
601               d.x = (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_af88b946fb90d5f08b5fb740c70e98c10}{x} - cicCoord.x) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
602               d.y = (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab927965981178aa1fba979a37168db2a}{y} - cicCoord.y) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
603               d.z = (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab3e6ed577a7c669c19de1f9c1b46c872}{z} - cicCoord.z) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
604 
605               t.x = 1.0 - d.x;
606               t.y = 1.0 - d.y;
607               t.z = 1.0 - d.z;
608 
609               \textcolor{comment}{/* interpolating back to cells */}
610               \textcolor{comment}{/* scaling from mol/cm^3 to mol/cell */}
611               \textcolor{keywordflow}{for} (f = 0; f < \hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}; f++) \{
612                 \hyperlink{global_8h_a25e4317a1b5bb95a8e71e0e8c4e11f2b}{cellFields}[f][c] += \hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches}[p][f * 
      \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + 
      \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.x + \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.y + idx.z] * (ax * d.x + (1 - ax) * t.x) * (ay * d.y + (1 - ay) * t.y) * (az * d.z + (1 - az) * t.
      z);  \textcolor{comment}{//*cellVolume;}
613               \}
614               \textcolor{keywordflow}{for} (f = 0; f < \hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}; f++) \{
615                 \hyperlink{global_8h_a25e4317a1b5bb95a8e71e0e8c4e11f2b}{cellFields}[\hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}+3*f][c] += \hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches}[p][
      \hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}* \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + f * 3 * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + 3 * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.x + 3* 
      \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.y + 3 * idx.z] * (ax * d.x + (1 - ax) * t.x) * (ay * d.y + (1 - ay) * t.y) *
       (az * d.z + (1 - az) * t.z);
616                 \hyperlink{global_8h_a25e4317a1b5bb95a8e71e0e8c4e11f2b}{cellFields}[\hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}+3*f+1][c] += \hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches}[p][
      \hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}* \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + f * 3 * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + 3 * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.x + 3* 
      \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.y + 3 * idx.z + 1] * (ax * d.x + (1 - ax) * t.x) * (ay * d.y + (1 - ay) * t.
      y) * (az * d.z + (1 - az) * t.z);
617                 \hyperlink{global_8h_a25e4317a1b5bb95a8e71e0e8c4e11f2b}{cellFields}[\hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}+3*f+2][c] += \hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches}[p][
      \hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}* \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + f * 3 * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + 3 * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.x + 3* 
      \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * idx.y + 3 * idx.z + 2] * (ax * d.x + (1 - ax) * t.x) * (ay * d.y + (1 - ay) * t.
      y) * (az * d.z + (1 - az) * t.z);
618               \}
619             \}           \textcolor{comment}{// if}
620           \}         \textcolor{comment}{// az}
621     \}               \textcolor{comment}{// p}
622   \}             \textcolor{comment}{// c}
623 
624   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++)
625     free(\hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches}[p]);
626   free(\hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches});
627 
628   \textcolor{keywordflow}{return};
629 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a08111192411fead96613d994aa95f960_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a3e968c18c11bbe46df754e7eca593b33}{\index{interp.\-c@{interp.\-c}!apply\-Patches@{apply\-Patches}}
\index{apply\-Patches@{apply\-Patches}!interp.c@{interp.\-c}}
\subsubsection[{apply\-Patches}]{\setlength{\rightskip}{0pt plus 5cm}int apply\-Patches (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a3e968c18c11bbe46df754e7eca593b33}
Update local tissue\-Field part with information from remote processes received in patches. Receiveing patches are deallocated here. 

Definition at line 345 of file interp.\-c.



References bvsim, cic\-Intersect, cic\-Patch, cic\-Recv\-Patch, cic\-Sender, grid\-End\-Idx, grid\-Size, grid\-Start\-Idx, M\-P\-Irank, M\-P\-Isize, tissue\-Field, vessel\-Field, x, int64\-Vector3d\-::x, double\-Vector3d\-::y, int64\-Vector3d\-::y, double\-Vector3d\-::z, and int64\-Vector3d\-::z.


\begin{DoxyCode}
346 \{
347 
348   \textcolor{keywordtype}{int} p;
349   \textcolor{keywordtype}{int} i;
350 
351   \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; i++) \{
352     \hyperlink{fields_8h_a55b7734feef0881a48041f5c8b0fe434}{tissueField}[i] = 0.0;
353     \textcolor{keywordflow}{if}(\hyperlink{global_8h_a975a504c34469eed96d609d621cfa35a}{bvsim}) \hyperlink{fields_8h_a6ef295c3b0816bc488287d089220ac10}{vesselField}[i] = 0.0;
354   \}
355 
356   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
357     \textcolor{keywordtype}{int} i, j, k;
358     \textcolor{keywordflow}{if} (!\hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender}[p])
359       \textcolor{keywordflow}{continue};
360     \textcolor{keywordflow}{for} (i = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}; i <= \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
361       \textcolor{keywordflow}{for} (j = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structdoubleVector3d_ab927965981178aa1fba979a37168db2a}{y}; j <= \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
362         \textcolor{keywordflow}{for} (k = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structdoubleVector3d_ab3e6ed577a7c669c19de1f9c1b46c872}{z}; k <= 
      \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k++) \{
363           \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} c, g, size;
364           size.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} = \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} + 1;
365           size.y = \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} + 1;
366           size.z = \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + 1;
367           c.x = i - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
368           c.y = j - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
369           c.z = k - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
370           \textcolor{keywordflow}{if} (i >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x} && i <= 
      \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}
371               && j >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} && j <= 
      \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}
372               && k >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}
373               && k <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}) \{
374             g.x = i - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
375             g.y = j - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
376             g.z = k - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
377             \hyperlink{fields_8h_a55b7734feef0881a48041f5c8b0fe434}{tissueField}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * g.x + 
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * g.y +
378                         g.z] +=
379                           \hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cicRecvPatch}[p][size.z * size.y * c.x + size.z * c.y +
380                                           c.z];
381             \textcolor{keywordflow}{if}(\hyperlink{global_8h_a975a504c34469eed96d609d621cfa35a}{bvsim}) \hyperlink{fields_8h_a6ef295c3b0816bc488287d089220ac10}{vesselField}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * g.x + \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * g.y +
382                                     g.z] +=
383                                       \hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cicRecvPatch}[p][size.z * size.y * c.x + size.z * c.y +
384                                                       c.z+size.x*size.y*size.z];
385           \}
386         \}
387     free(\hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cicRecvPatch}[p]);
388   \}
389 
390   free(\hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cicRecvPatch});
391 
392   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++)
393     \textcolor{keywordflow}{if} (\hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cicIntersect}[p])
394       free(\hyperlink{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}{cicPatch}[p]);
395 
396   free(\hyperlink{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}{cicPatch});
397   \textcolor{keywordflow}{return} 0;
398 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a3e968c18c11bbe46df754e7eca593b33_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a09ed91c5c40f3937e10c8c60c2b8fb7f}{\index{interp.\-c@{interp.\-c}!do\-Interpolation@{do\-Interpolation}}
\index{do\-Interpolation@{do\-Interpolation}!interp.c@{interp.\-c}}
\subsubsection[{do\-Interpolation}]{\setlength{\rightskip}{0pt plus 5cm}void do\-Interpolation (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a09ed91c5c40f3937e10c8c60c2b8fb7f}
For each local cell its density value is interpolated accross neighbouring grid vertices with the use of Cloud-\/\-In-\/\-Cell method. Computed values are stored in patches instead in field buffers. No additional memory allocations are made here. 

Definition at line 181 of file interp.\-c.



References cells, grid\-End\-Idx, grid\-Resolution, grid\-Start\-Idx, lnc, M\-P\-Isize, N\-I\-F, patch, x, cell\-Data\-::x, double\-Vector3d\-::x, int64\-Vector3d\-::x, cell\-Data\-::y, double\-Vector3d\-::y, int64\-Vector3d\-::y, cell\-Data\-::z, double\-Vector3d\-::z, and int64\-Vector3d\-::z.


\begin{DoxyCode}
182 \{
183 
184   \textcolor{keywordtype}{int} c, i, p, j, k, f;
185   \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} idx;
186   \textcolor{keyword}{struct }\hyperlink{structdoubleVector3d}{doubleVector3d} d, t;
187   \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} cellIdx;
188   \textcolor{keyword}{struct }\hyperlink{structdoubleVector3d}{doubleVector3d} cicCoord;
189 
190   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++)
191     \textcolor{keywordflow}{for}(f = 0; f < \hyperlink{fields_8h_a1afe765b4510add91239ee23e5a89ba4}{NIF}; f++)
192       \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
193         \textcolor{keywordflow}{for} (j = 0; j < \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
194           \textcolor{keywordflow}{for} (k = 0; k < \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k++)
195             \hyperlink{interp_8c_a0817af402f7cf7ac0309520dbcd5b71d}{patch}(p, f, i, j, k) = 0.0;
196 
197   \textcolor{keywordflow}{for} (c = 0; c < \hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}; c++) \{
198 
199     cellIdx.x = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_af88b946fb90d5f08b5fb740c70e98c10}{x} - lowerGridCorner.x) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
200     cellIdx.y = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab927965981178aa1fba979a37168db2a}{y} - lowerGridCorner.y) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
201     cellIdx.z = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab3e6ed577a7c669c19de1f9c1b46c872}{z} - lowerGridCorner.z) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
202 
203     \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
204       \textcolor{keywordtype}{int} ax, ay, az;
205       \textcolor{keywordflow}{for} (ax = 0; ax < 2; ax++)
206         \textcolor{keywordflow}{for} (ay = 0; ay < 2; ay++)
207           \textcolor{keywordflow}{for} (az = 0; az < 2; az++) \{
208             \textcolor{keywordflow}{if} (cellIdx.x + ax >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}
209                 && cellIdx.y + ay >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}
210                 && cellIdx.z + az >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}
211                 && cellIdx.x + ax <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}
212                 && cellIdx.y + ay <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}
213                 && cellIdx.z + az <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}) \{
214 
215               idx.x = (cellIdx.x + ax) - \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x};
216               idx.y = (cellIdx.y + ay) - \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structdoubleVector3d_ab927965981178aa1fba979a37168db2a}{y};
217               idx.z = (cellIdx.z + az) - \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structdoubleVector3d_ab3e6ed577a7c669c19de1f9c1b46c872}{z};
218 
219               cicCoord.x = lowerGridCorner.x + cellIdx.x * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
220               cicCoord.y = lowerGridCorner.y + cellIdx.y * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
221               cicCoord.z = lowerGridCorner.z + cellIdx.z * \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
222 
223               d.x = (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_af88b946fb90d5f08b5fb740c70e98c10}{x} - cicCoord.x) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
224               d.y = (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab927965981178aa1fba979a37168db2a}{y} - cicCoord.y) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
225               d.z = (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab3e6ed577a7c669c19de1f9c1b46c872}{z} - cicCoord.z) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
226 
227               t.x = 1.0 - d.x;
228               t.y = 1.0 - d.y;
229               t.z = 1.0 - d.z;
230 
231               \textcolor{keywordflow}{if}(\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].ctype==1) \{ \textcolor{comment}{/* endothelial cell - production */}
232                 \hyperlink{interp_8c_a0817af402f7cf7ac0309520dbcd5b71d}{patch}(p,1,idx.x,idx.y,idx.z) +=
233                   1.0 * (ax * d.x + (1 - ax) * t.x) * (ay * d.y +
234                                                        (1 -
235                                                         ay) * t.y) *
236                   (az * d.z + (1 - az) * t.z);
237               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].phase != 5) \{    \textcolor{comment}{/* if not in necrotic phase */}
238                 \textcolor{keywordflow}{if} (\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].phase == 0) \{ \textcolor{comment}{/* if in G0 phase - lower consumption */}
239                   \hyperlink{interp_8c_a0817af402f7cf7ac0309520dbcd5b71d}{patch}(p,0, idx.x, idx.y, idx.z) +=
240                     0.75 * (ax * d.x + (1 - ax) * t.x) * (ay * d.y +
241                                                           (1 -
242                                                               ay) * t.y) *
243                     (az * d.z + (1 - az) * t.z);
244                 \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{/* if not in G0 phase - normal consumption */}
245                   \hyperlink{interp_8c_a0817af402f7cf7ac0309520dbcd5b71d}{patch}(p,0, idx.x, idx.y, idx.z) +=
246                     1.0 * (ax * d.x + (1 - ax) * t.x) * (ay * d.y +
247                                                          (1 -
248                                                           ay) * t.y) *
249                     (az * d.z + (1 - az) * t.z);
250                 \}
251               \}
252 
253             \}
254           \}
255     \}
256   \}
257   \textcolor{keywordflow}{return};
258 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a09ed91c5c40f3937e10c8c60c2b8fb7f_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a4299a7e9993adbe7a047b835b2339550}{\index{interp.\-c@{interp.\-c}!find\-Patches@{find\-Patches}}
\index{find\-Patches@{find\-Patches}!interp.c@{interp.\-c}}
\subsubsection[{find\-Patches}]{\setlength{\rightskip}{0pt plus 5cm}void find\-Patches (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a4299a7e9993adbe7a047b835b2339550}
For each local cell we check its position in the grid. If cell is located in the grid partition of other process then the information about this cell should be send to remote process by M\-P\-I communication. This is done by preparing special patches and sending the information on all bunch of cells rather than sendind it one by one. This function identifies patches and allocate memory buffers for patches. 

Definition at line 60 of file interp.\-c.



References cells, cic\-Intersect, cic\-Patch, grid\-End\-Idx, grid\-Resolution, grid\-Start\-Idx, lnc, M\-P\-Isize, N\-I\-F, sdim, x, cell\-Data\-::x, int64\-Vector3d\-::x, cell\-Data\-::y, int64\-Vector3d\-::y, cell\-Data\-::z, and int64\-Vector3d\-::z.


\begin{DoxyCode}
61 \{
62 
63   \textcolor{keywordtype}{int} c,p;
64   \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} cellIdx;
65 
66   \hyperlink{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}{cicPatch} = (\textcolor{keywordtype}{double} **) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double} *));
67   \hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cicIntersect} = (\textcolor{keywordtype}{int} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
68   \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner} =
69     (\textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize},
70                                     \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}));
71   \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner} =
72     (\textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize},
73                                     \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}));
74   \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR} =
75     (\textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize},
76                                     \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}));
77   \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR} =
78     (\textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize},
79                                     \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}));
80   \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize} =
81     (\textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize},
82                                     \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}));
83   \textcolor{comment}{//patchSizeR =}
84   \textcolor{comment}{//    (struct int64Vector3d *) calloc(MPIsize,}
85 \textcolor{comment}{//                    sizeof(struct int64Vector3d));}
86 
87   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
88     \hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cicIntersect}[p] = 0;
89     \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} = 0;
90     \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} = 0;
91     \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} = 0;
92     \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} = INT\_MAX;
93     \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} = INT\_MAX;
94     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a9fad6472ef73b07a138721c11022697a}{sdim} == 3)
95       \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} = INT\_MAX;
96     \textcolor{keywordflow}{else}
97       \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} = 0;
98     \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} = INT\_MIN, \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} = INT\_MIN;
99     \textcolor{keywordflow}{if} (\hyperlink{global_8h_a9fad6472ef73b07a138721c11022697a}{sdim} == 3)
100       \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} = INT\_MIN;
101     \textcolor{keywordflow}{else}
102       \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} = 0;
103   \}
104 
105   \textcolor{comment}{//#pragma omp parallel for default(none) private(p,c,cellIdx)
       shared(cells,gridResolution,lnc,MPIsize,gridStartIdx,gridEndIdx,lowerPatchCorner,upperPatchCorner,cicIntersect,sdim,lowerGridCorner)}
106   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
107 
108     \textcolor{keywordflow}{for} (c = 0; c < \hyperlink{global_8h_a7065c019590815f10169c219f358e7d0}{lnc}; c++) \{
109 
110       \textcolor{keywordtype}{int} ax, ay, az;
111 
112       cellIdx.x = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_af88b946fb90d5f08b5fb740c70e98c10}{x} - lowerGridCorner.x) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
113       cellIdx.y = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab927965981178aa1fba979a37168db2a}{y} - lowerGridCorner.y) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
114       cellIdx.z = ((\hyperlink{global_8h_a3ea537bde8d64e54770a2bd81e3f00be}{cells}[c].\hyperlink{structcellData_ab3e6ed577a7c669c19de1f9c1b46c872}{z} - lowerGridCorner.z) / \hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution});
115 
116       \textcolor{keywordflow}{for} (ax = 0; ax < 2; ax++)
117         \textcolor{keywordflow}{for} (ay = 0; ay < 2; ay++)
118           \textcolor{keywordflow}{for} (az = 0; az < 2; az++) \{
119 
120             \textcolor{keywordflow}{if} (cellIdx.x + ax >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}
121                 && cellIdx.y + ay >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}
122                 && cellIdx.z + az >= \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}
123                 && cellIdx.x + ax <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}
124                 && cellIdx.y + ay <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}
125                 && cellIdx.z + az <= \hyperlink{fields_8h_a1d13a1c43b1a6eb6ca088b79ee681b48}{gridEndIdx}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}) \{
126               \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} =
127                 (\hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} >
128                  cellIdx.x + ax ? cellIdx.x +
129                  ax : \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x});
130               \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} =
131                 (\hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} >
132                  cellIdx.y + ay ? cellIdx.y +
133                  ay : \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y});
134               \textcolor{keywordflow}{if} (\hyperlink{global_8h_a9fad6472ef73b07a138721c11022697a}{sdim} == 3)
135                 \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} =
136                   (\hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} >
137                    cellIdx.z + az ? cellIdx.z +
138                    az : \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z});
139               \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} =
140                 (\hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} <
141                  cellIdx.x + ax ? cellIdx.x +
142                  ax : \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x});
143               \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} =
144                 (\hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} <
145                  cellIdx.y + ay ? cellIdx.y +
146                  ay : \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y});
147               \textcolor{keywordflow}{if} (\hyperlink{global_8h_a9fad6472ef73b07a138721c11022697a}{sdim} == 3)
148                 \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} =
149                   (\hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} <
150                    cellIdx.z + az ? cellIdx.z +
151                    az : \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z});
152 
153               \hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cicIntersect}[p] = 1;
154             \}
155           \}
156     \}
157   \}
158 
159   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++)
160     \textcolor{keywordflow}{if} (\hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cicIntersect}[p]) \{
161       \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} = \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} - 
      \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} + 1;
162       \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} = \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} - 
      \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} + 1;
163       \textcolor{keywordflow}{if} (\hyperlink{global_8h_a9fad6472ef73b07a138721c11022697a}{sdim} == 3)
164         \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} = \hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} - 
      \hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + 1;
165       \textcolor{keywordflow}{else}
166         \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} = 1;
167       cicPatch[p] =
168         (\textcolor{keywordtype}{double} *) calloc(\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} *
169                           \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_a1afe765b4510add91239ee23e5a89ba4}{NIF}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
170     \}
171 
172   \textcolor{keywordflow}{return};
173 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a4299a7e9993adbe7a047b835b2339550_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_ad862fb7e08b1dee6d784a09a26978ada}{\index{interp.\-c@{interp.\-c}!init\-Cells\-To\-Grid\-Exchange@{init\-Cells\-To\-Grid\-Exchange}}
\index{init\-Cells\-To\-Grid\-Exchange@{init\-Cells\-To\-Grid\-Exchange}!interp.c@{interp.\-c}}
\subsubsection[{init\-Cells\-To\-Grid\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void init\-Cells\-To\-Grid\-Exchange (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_ad862fb7e08b1dee6d784a09a26978ada}
This function initializes data exchange between processes required in cells-\/to-\/grid interpolation. This function enables overlapping communication and computations. 

Definition at line 652 of file interp.\-c.



References do\-Interpolation(), find\-Patches(), gfields, and init\-Patch\-Exchange().


\begin{DoxyCode}
653 \{
654   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
655     \textcolor{keywordflow}{return};
656   \hyperlink{interp_8c_a4299a7e9993adbe7a047b835b2339550}{findPatches}();
657   \hyperlink{interp_8c_a09ed91c5c40f3937e10c8c60c2b8fb7f}{doInterpolation}();
658   \hyperlink{interp_8c_a085ef29ed8159779989ae8fac05fd699}{initPatchExchange}();
659 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{interp_8c_ad862fb7e08b1dee6d784a09a26978ada_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_ad862fb7e08b1dee6d784a09a26978ada_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a4fe8eca69017d7e0f87fd2c6cdb9b2e2}{\index{interp.\-c@{interp.\-c}!init\-Fields\-Patches\-Exchange@{init\-Fields\-Patches\-Exchange}}
\index{init\-Fields\-Patches\-Exchange@{init\-Fields\-Patches\-Exchange}!interp.c@{interp.\-c}}
\subsubsection[{init\-Fields\-Patches\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void init\-Fields\-Patches\-Exchange (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a4fe8eca69017d7e0f87fd2c6cdb9b2e2}
Now each local cell should receive information about values of global fields in the grid. Field patches are filled with appropriate values. Non-\/blocking communication is initiated. This is executed after global fields are computed. Field patches buffers are allocated here. Sizes of the patches are the same as those from previous C\-I\-C communication. Receiving field patches are also allocated here. M\-P\-I\-\_\-\-Request tables are allocated here. 

Definition at line 411 of file interp.\-c.



References B\-V\-E\-S, bvsim, cic\-Receiver, cic\-Req\-Recv, cic\-Req\-Send, cic\-Sender, field\-Addr, fields\-Patches, fields\-Patches\-Comm\-Buff, G\-L\-U\-C, glucose, grad\-Addr, grid\-Size, grid\-Start\-Idx, H\-Y\-D\-R, hydrogen\-Ion, M\-P\-Irank, M\-P\-Isize, N\-C\-H\-E\-M, N\-F\-I\-E\-L\-D\-S, N\-G\-L\-O\-B, O\-X\-Y\-G, oxygen, stop\-Run(), T\-E\-M\-P, temperature, x, int64\-Vector3d\-::x, int64\-Vector3d\-::y, and int64\-Vector3d\-::z.


\begin{DoxyCode}
412 \{
413 
414   \textcolor{keywordtype}{int} f;            \textcolor{comment}{/* fields index */}
415   \textcolor{keywordtype}{int} p;            \textcolor{comment}{/* process index */}
416   \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} idx, g;
417   \textcolor{keyword}{struct }\hyperlink{structint64Vector3d}{int64Vector3d} size;
418 
419   \hyperlink{fields_8h_af5c78cf0ef851175243d9f71767efe50}{fieldsPatchesCommBuff} = (\textcolor{keywordtype}{double} **) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double} *));
420   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
421     \textcolor{keywordtype}{int} fieldPatchSize;
422     \textcolor{keywordflow}{if} (!\hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender}[p])
423       \textcolor{keywordflow}{continue};         \textcolor{comment}{/* continue to next process if current process do not overlap domain */}
424     size.x = \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} + 1;
425     size.y = \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} + 1;
426     size.z = \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} + 1;
427     fieldPatchSize = size.x * size.y * size.z;
428     fieldsPatchesCommBuff[p] =
429       (\textcolor{keywordtype}{double} *) calloc((\hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}+\hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}*3) * fieldPatchSize, \textcolor{keyword}{sizeof}(double));
430     \textcolor{comment}{/* fields */}
431     \textcolor{keywordflow}{for} (f = 0; f < \hyperlink{fields_8h_a7986f01c038f396ce7df280bb2903099}{NFIELDS}; f++) \{
432       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_a742eb2b2de51e39b1ce4e1ceb3bdc8f1}{BVES} && !\hyperlink{global_8h_a975a504c34469eed96d609d621cfa35a}{bvsim}) \textcolor{keywordflow}{continue};
433       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_a10bed19ceedeb2c12c5aad6de1d3b1a1}{TEMP} && !\hyperlink{fields_8h_a0ac2a299549fcca3cd14e4c1ac2087d2}{temperature}) \textcolor{keywordflow}{continue};
434       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_a5e74e9586fb0eac40835526c74bcb0bc}{OXYG} && !\hyperlink{fields_8h_a67dd60f843bcdd47eb1503456d0da5de}{oxygen}) \textcolor{keywordflow}{continue};
435       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_acc998936c8c53109a36722f057e21352}{GLUC} && !\hyperlink{fields_8h_aa70f92ad44ec1687a70b41b3c3e5fa45}{glucose}) \textcolor{keywordflow}{continue};
436       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_a985ad19b505d54de3ae5d490dfb2e8c5}{HYDR} && !\hyperlink{fields_8h_a0bd8292376c22b63b67fc99aa6f51986}{hydrogenIon}) \textcolor{keywordflow}{continue};
437       int64\_t i, j, k;
438       \textcolor{keywordflow}{for} (i = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}; i <= \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
439         \textcolor{keywordflow}{for} (j = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j <= 
      \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
440           \textcolor{keywordflow}{for} (k = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k <= 
      \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
441                k++) \{
442             idx.x = i - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
443             idx.y = j - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
444             idx.z = k - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
445             g.x = i - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
446             g.y = j - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
447             g.z = k - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
448             fieldsPatchesCommBuff[p][f * fieldPatchSize +
449                                      size.z * size.y * idx.x +
450                                      size.z * idx.y + idx.z] =
451                                        ((\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[f])[
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * g.x +
452                                            \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * g.y + g.z];
453           \}
454     \}
455     \textcolor{comment}{/* field gradients */}
456     \textcolor{keywordflow}{for} (f = 0; f < \hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}; f++) \{
457       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_a5e74e9586fb0eac40835526c74bcb0bc}{OXYG}-\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB} && !\hyperlink{fields_8h_a67dd60f843bcdd47eb1503456d0da5de}{oxygen}) \textcolor{keywordflow}{continue};
458       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_acc998936c8c53109a36722f057e21352}{GLUC}-\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB} && !\hyperlink{fields_8h_aa70f92ad44ec1687a70b41b3c3e5fa45}{glucose}) \textcolor{keywordflow}{continue};
459       \textcolor{keywordflow}{if}(f==\hyperlink{fields_8h_a985ad19b505d54de3ae5d490dfb2e8c5}{HYDR}-\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB} && !\hyperlink{fields_8h_a0bd8292376c22b63b67fc99aa6f51986}{hydrogenIon}) \textcolor{keywordflow}{continue};
460       int64\_t i, j, k;
461       \textcolor{keywordflow}{for} (i = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x}; i <= \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
462         \textcolor{keywordflow}{for} (j = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j <= 
      \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
463           \textcolor{keywordflow}{for} (k = \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k <= 
      \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
464                k++) \{
465             idx.x = i - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
466             idx.y = j - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
467             idx.z = k - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
468             g.x = i - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x};
469             g.y = j - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y};
470             g.z = k - \hyperlink{fields_8h_a9154f33f7786c05c61f4d519da14d501}{gridStartIdx}[\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z};
471             fieldsPatchesCommBuff[p][fieldPatchSize*NFIELDS + f * 3 * fieldPatchSize +
472                                      3* size.z * size.y * idx.x +
473                                      3* size.z * idx.y + 3*idx.z] =
474                                        ((\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[f])[3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * g.x +
475                                            3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * g.y + 3*g.z];
476             fieldsPatchesCommBuff[p][fieldPatchSize*NFIELDS + f * 3 * fieldPatchSize +
477                                      3* size.z * size.y * idx.x +
478                                      3* size.z * idx.y + 3*idx.z + 1] =
479                                        ((\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[f])[3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * g.x +
480                                            3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * g.y + 3*g.z + 1];
481             fieldsPatchesCommBuff[p][fieldPatchSize*NFIELDS + f * 3 * fieldPatchSize +
482                                      3* size.z * size.y * idx.x +
483                                      3* size.z * idx.y + 3* idx.z + 2] =
484                                        ((\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[f])[3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * g.x +
485                                            3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * g.y + 3*g.z + 2];
486           \}
487     \}
488 
489   \}
490 
491   \textcolor{keywordflow}{if} (!(\hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches} = (\textcolor{keywordtype}{double} **) calloc(MPIsize, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double} *))))
492     \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(106, \textcolor{stringliteral}{"fieldsPatches"}, \_\_FILE\_\_, \_\_LINE\_\_);
493 
494   \hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend} = (MPI\_Request *) malloc(\textcolor{keyword}{sizeof}(MPI\_Request) * \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize});
495   \hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv} = (MPI\_Request *) malloc(\textcolor{keyword}{sizeof}(MPI\_Request) * \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize});
496 
497   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
498     \textcolor{keywordflow}{if} (\hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender}[p]) \{
499       \textcolor{keywordtype}{int} sendSize;
500       sendSize =
501         (\hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} +
502          1) * (\hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} +
503                1) * (\hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} - 
      \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} +
504                      1) * (NFIELDS+NCHEM*3);
505       MPI\_Isend(&(fieldsPatchesCommBuff[p][0]), sendSize, MPI\_DOUBLE, p,
506                 \hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}, MPI\_COMM\_WORLD, &\hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend}[p]);
507     \}
508     \textcolor{keywordflow}{if} (\hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver}[p]) \{
509       \textcolor{keywordtype}{int} recvSize;
510       recvSize =
511         \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * (NFIELDS+NCHEM*3);
512       \textcolor{keywordflow}{if} (!
513           (\hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches}[p] = (\textcolor{keywordtype}{double} *) calloc(recvSize, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}))))
514         \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(106, \textcolor{stringliteral}{"fieldsPatches"}, \_\_FILE\_\_, \_\_LINE\_\_);
515       MPI\_Irecv(&(\hyperlink{fields_8h_a978db43304285c6d893667023bd6bfb9}{fieldsPatches}[p][0]), recvSize, MPI\_DOUBLE, p, p,
516                 MPI\_COMM\_WORLD, &\hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv}[p]);
517     \}
518   \}
519   \textcolor{keywordflow}{return};
520 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{interp_8c_a4fe8eca69017d7e0f87fd2c6cdb9b2e2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a4fe8eca69017d7e0f87fd2c6cdb9b2e2_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a085ef29ed8159779989ae8fac05fd699}{\index{interp.\-c@{interp.\-c}!init\-Patch\-Exchange@{init\-Patch\-Exchange}}
\index{init\-Patch\-Exchange@{init\-Patch\-Exchange}!interp.c@{interp.\-c}}
\subsubsection[{init\-Patch\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void init\-Patch\-Exchange (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a085ef29ed8159779989ae8fac05fd699}
Patches are being sent to receiving processes with non-\/blocking communication scheme (Isend, Irecv). Receiving patches are allocated here. M\-P\-I\-\_\-\-Request tables are allocated here. 

Definition at line 266 of file interp.\-c.



References cic\-Intersect, cic\-Patch, cic\-Receiver, cic\-Recv\-Patch, cic\-Req\-Recv, cic\-Req\-Send, cic\-Sender, M\-P\-Irank, M\-P\-Isize, N\-I\-F, x, int64\-Vector3d\-::x, double\-Vector3d\-::y, double\-Vector3d\-::z, and int64\-Vector3d\-::z.


\begin{DoxyCode}
267 \{
268   \textcolor{keywordtype}{int} p;
269 
270   \hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver} = (\textcolor{keywordtype}{int} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
271   \hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender} = (\textcolor{keywordtype}{int} *) calloc(\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
272 
273   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++)
274     \hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver}[p] = \hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cicIntersect}[p];
275 
276   MPI\_Alltoall(\hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver}, 1, MPI\_INT, \hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender}, 1, MPI\_INT,
277                MPI\_COMM\_WORLD);
278 
279   MPI\_Alltoall(\hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner}, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}), MPI\_BYTE,
280                \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}), MPI\_BYTE,
281                MPI\_COMM\_WORLD);
282   MPI\_Alltoall(\hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner}, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}), MPI\_BYTE,
283                \hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{structint64Vector3d}{int64Vector3d}), MPI\_BYTE,
284                MPI\_COMM\_WORLD);
285 
286   \hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cicRecvPatch} = (\textcolor{keywordtype}{double} **) calloc(MPIsize, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double} *));
287   \hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend} = (MPI\_Request *) malloc(\textcolor{keyword}{sizeof}(MPI\_Request) * \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize});
288   \hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv} = (MPI\_Request *) malloc(\textcolor{keyword}{sizeof}(MPI\_Request) * \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize});
289 
290   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
291     \textcolor{keywordflow}{if} (\hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver}[p]) \{
292       MPI\_Isend(&(\hyperlink{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}{cicPatch}[p][0]),
293                 \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{tempf_8c_a1780e9c70637026d6fab31f63b3a193e}{x} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize}[p].
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * \hyperlink{fields_8h_a1afe765b4510add91239ee23e5a89ba4}{NIF},
294                 MPI\_DOUBLE, p, \hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank}, MPI\_COMM\_WORLD, &\hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend}[p]);
295     \}
296     \textcolor{keywordflow}{if} (\hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender}[p]) \{
297       \textcolor{keywordtype}{int} recvSize;
298       recvSize =
299         (\hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} +
300          1) * (\hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} - \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} +
301                1) * (\hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} - 
      \hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR}[p].\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} +
302                      1);
303       \textcolor{keywordflow}{if} (!(\hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cicRecvPatch}[p] = (\textcolor{keywordtype}{double} *) calloc(recvSize*\hyperlink{fields_8h_a1afe765b4510add91239ee23e5a89ba4}{NIF}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}))))
304         exit(0);
305       MPI\_Irecv(&(\hyperlink{interp_8c_aa694a54cf85528e82466805524525b7d}{cicRecvPatch}[p][0]), recvSize * NIF, MPI\_DOUBLE, p, p,
306                 MPI\_COMM\_WORLD, &\hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv}[p]);
307     \}
308   \}
309   \textcolor{keywordflow}{return};
310 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a085ef29ed8159779989ae8fac05fd699_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_ace868928ce5497cc3edc942bd5c8f396}{\index{interp.\-c@{interp.\-c}!interpolate\-Cells\-To\-Grid@{interpolate\-Cells\-To\-Grid}}
\index{interpolate\-Cells\-To\-Grid@{interpolate\-Cells\-To\-Grid}!interp.c@{interp.\-c}}
\subsubsection[{interpolate\-Cells\-To\-Grid}]{\setlength{\rightskip}{0pt plus 5cm}void interpolate\-Cells\-To\-Grid (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_ace868928ce5497cc3edc942bd5c8f396}
This is a driving function interpolating cellular data to grid data. This function does not enable overlapping communication and computations. 

Definition at line 637 of file interp.\-c.



References apply\-Patches(), do\-Interpolation(), find\-Patches(), init\-Patch\-Exchange(), and wait\-Patch\-Exchange().


\begin{DoxyCode}
638 \{
639   \hyperlink{interp_8c_a4299a7e9993adbe7a047b835b2339550}{findPatches}();
640   \hyperlink{interp_8c_a09ed91c5c40f3937e10c8c60c2b8fb7f}{doInterpolation}();
641   \hyperlink{interp_8c_a085ef29ed8159779989ae8fac05fd699}{initPatchExchange}();
642   \hyperlink{interp_8c_a4124511b40767952ed61d5ae30bae7b6}{waitPatchExchange}();
643   \hyperlink{interp_8c_a3e968c18c11bbe46df754e7eca593b33}{applyPatches}();
644 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_ace868928ce5497cc3edc942bd5c8f396_cgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a7f8b42e40580516283e6f43ce7fe6389}{\index{interp.\-c@{interp.\-c}!interpolate\-Fields\-To\-Cells@{interpolate\-Fields\-To\-Cells}}
\index{interpolate\-Fields\-To\-Cells@{interpolate\-Fields\-To\-Cells}!interp.c@{interp.\-c}}
\subsubsection[{interpolate\-Fields\-To\-Cells}]{\setlength{\rightskip}{0pt plus 5cm}void interpolate\-Fields\-To\-Cells (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a7f8b42e40580516283e6f43ce7fe6389}
This function is used to interpolate field data back to cells. Overlapping of communication and computations is not implemented here. This function deallocates all important arrays used in interpolation. 

Definition at line 681 of file interp.\-c.



References apply\-Fields\-Patches(), cic\-Intersect, cic\-Receiver, cic\-Sender, gfields, init\-Fields\-Patches\-Exchange(), and wait\-Fields\-Patches\-Exchange().


\begin{DoxyCode}
682 \{
683   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
684     \textcolor{keywordflow}{return};
685 
686   \hyperlink{interp_8c_a4fe8eca69017d7e0f87fd2c6cdb9b2e2}{initFieldsPatchesExchange}();
687   \hyperlink{interp_8c_a751d539b1af7ca1f9ce8e55a91084874}{waitFieldsPatchesExchange}();
688   \hyperlink{interp_8c_a08111192411fead96613d994aa95f960}{applyFieldsPatches}();
689 
690   free(\hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver});
691   free(\hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender});
692   free(\hyperlink{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{cicIntersect});
693 
694   free(\hyperlink{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{lowerPatchCorner});
695   free(\hyperlink{interp_8c_a1ad7766a77930978570efda9dc79c423}{upperPatchCorner});
696   free(\hyperlink{interp_8c_a2376cd58453249d9c7665fa650751766}{lowerPatchCornerR});
697   free(\hyperlink{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{upperPatchCornerR});
698   free(\hyperlink{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{patchSize});
699   \textcolor{comment}{//free(patchSizeR);}
700 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a7f8b42e40580516283e6f43ce7fe6389_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a7f8b42e40580516283e6f43ce7fe6389_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_ac7fd669461f281bbaceac377028fb722}{\index{interp.\-c@{interp.\-c}!wait\-Cells\-To\-Grid\-Exchange@{wait\-Cells\-To\-Grid\-Exchange}}
\index{wait\-Cells\-To\-Grid\-Exchange@{wait\-Cells\-To\-Grid\-Exchange}!interp.c@{interp.\-c}}
\subsubsection[{wait\-Cells\-To\-Grid\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void wait\-Cells\-To\-Grid\-Exchange (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_ac7fd669461f281bbaceac377028fb722}
This function wait for patches communication to finish in cells-\/to-\/grid interpolation. This function enables overlapping communication and computations. 

Definition at line 667 of file interp.\-c.



References apply\-Patches(), gfields, and wait\-Patch\-Exchange().


\begin{DoxyCode}
668 \{
669   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
670     \textcolor{keywordflow}{return};
671   \hyperlink{interp_8c_a4124511b40767952ed61d5ae30bae7b6}{waitPatchExchange}();
672   \hyperlink{interp_8c_a3e968c18c11bbe46df754e7eca593b33}{applyPatches}();
673 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_ac7fd669461f281bbaceac377028fb722_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_ac7fd669461f281bbaceac377028fb722_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a751d539b1af7ca1f9ce8e55a91084874}{\index{interp.\-c@{interp.\-c}!wait\-Fields\-Patches\-Exchange@{wait\-Fields\-Patches\-Exchange}}
\index{wait\-Fields\-Patches\-Exchange@{wait\-Fields\-Patches\-Exchange}!interp.c@{interp.\-c}}
\subsubsection[{wait\-Fields\-Patches\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void wait\-Fields\-Patches\-Exchange (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a751d539b1af7ca1f9ce8e55a91084874}
Wait for communication to finish. M\-P\-I\-\_\-\-Request tables are deallocated here. Field patches buffers are deallocated here. 

Definition at line 527 of file interp.\-c.



References cic\-Receiver, cic\-Req\-Recv, cic\-Req\-Send, cic\-Sender, fields\-Patches\-Comm\-Buff, M\-P\-Isize, and stop\-Run().


\begin{DoxyCode}
528 \{
529   \textcolor{keywordtype}{int} p;
530   MPI\_Status status;
531 
532   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
533     \textcolor{keywordflow}{if} (!\hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender}[p])
534       \textcolor{keywordflow}{continue};
535     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend}[p], &status) != MPI\_SUCCESS)
536       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"sending"}, \_\_FILE\_\_, \_\_LINE\_\_);
537   \}
538 
539   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
540     \textcolor{keywordflow}{if} (!\hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver}[p])
541       \textcolor{keywordflow}{continue};
542     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv}[p], &status) != MPI\_SUCCESS)
543       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"receiving"}, \_\_FILE\_\_, \_\_LINE\_\_);
544   \}
545 
546   free(\hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend});
547   free(\hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv});
548 
549   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++)
550     free(\hyperlink{fields_8h_af5c78cf0ef851175243d9f71767efe50}{fieldsPatchesCommBuff}[p]);
551   free(\hyperlink{fields_8h_af5c78cf0ef851175243d9f71767efe50}{fieldsPatchesCommBuff});
552 
553   \textcolor{keywordflow}{return};
554 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=310pt]{interp_8c_a751d539b1af7ca1f9ce8e55a91084874_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a751d539b1af7ca1f9ce8e55a91084874_icgraph}
\end{center}
\end{figure}


\hypertarget{interp_8c_a4124511b40767952ed61d5ae30bae7b6}{\index{interp.\-c@{interp.\-c}!wait\-Patch\-Exchange@{wait\-Patch\-Exchange}}
\index{wait\-Patch\-Exchange@{wait\-Patch\-Exchange}!interp.c@{interp.\-c}}
\subsubsection[{wait\-Patch\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}int wait\-Patch\-Exchange (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{interp_8c_a4124511b40767952ed61d5ae30bae7b6}
Wait for communication to finish. M\-P\-I\-\_\-\-Request tables are deallocated here. 

Definition at line 316 of file interp.\-c.



References cic\-Receiver, cic\-Req\-Recv, cic\-Req\-Send, cic\-Sender, M\-P\-Isize, and stop\-Run().


\begin{DoxyCode}
317 \{
318   \textcolor{keywordtype}{int} p;
319   MPI\_Status status;
320 
321   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
322     \textcolor{keywordflow}{if} (!\hyperlink{interp_8c_adb4ccb79955589454dc66b849d8701ec}{cicReceiver}[p])
323       \textcolor{keywordflow}{continue};
324     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend}[p], &status) != MPI\_SUCCESS)
325       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"sending"}, \_\_FILE\_\_, \_\_LINE\_\_);
326   \}
327 
328   \textcolor{keywordflow}{for} (p = 0; p < \hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}; p++) \{
329     \textcolor{keywordflow}{if} (!\hyperlink{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{cicSender}[p])
330       \textcolor{keywordflow}{continue};
331     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv}[p], &status) != MPI\_SUCCESS)
332       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"receiving"}, \_\_FILE\_\_, \_\_LINE\_\_);
333   \}
334 
335   free(\hyperlink{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{cicReqSend});
336   free(\hyperlink{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{cicReqRecv});
337 
338   \textcolor{keywordflow}{return} 0;
339 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{interp_8c_a4124511b40767952ed61d5ae30bae7b6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{interp_8c_a4124511b40767952ed61d5ae30bae7b6_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}{\index{interp.\-c@{interp.\-c}!cic\-Intersect@{cic\-Intersect}}
\index{cic\-Intersect@{cic\-Intersect}!interp.c@{interp.\-c}}
\subsubsection[{cic\-Intersect}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ cic\-Intersect}}\label{interp_8c_aa1e8e01a33edaeee7b43a257115fe3ed}


Definition at line 36 of file interp.\-c.

\hypertarget{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}{\index{interp.\-c@{interp.\-c}!cic\-Patch@{cic\-Patch}}
\index{cic\-Patch@{cic\-Patch}!interp.c@{interp.\-c}}
\subsubsection[{cic\-Patch}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$$\ast$ cic\-Patch}}\label{interp_8c_a7b2e819edbf39d5d976cff399612f6e8}


Definition at line 35 of file interp.\-c.

\hypertarget{interp_8c_adb4ccb79955589454dc66b849d8701ec}{\index{interp.\-c@{interp.\-c}!cic\-Receiver@{cic\-Receiver}}
\index{cic\-Receiver@{cic\-Receiver}!interp.c@{interp.\-c}}
\subsubsection[{cic\-Receiver}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ cic\-Receiver}}\label{interp_8c_adb4ccb79955589454dc66b849d8701ec}


Definition at line 37 of file interp.\-c.

\hypertarget{interp_8c_aa694a54cf85528e82466805524525b7d}{\index{interp.\-c@{interp.\-c}!cic\-Recv\-Patch@{cic\-Recv\-Patch}}
\index{cic\-Recv\-Patch@{cic\-Recv\-Patch}!interp.c@{interp.\-c}}
\subsubsection[{cic\-Recv\-Patch}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$$\ast$ cic\-Recv\-Patch}}\label{interp_8c_aa694a54cf85528e82466805524525b7d}


Definition at line 39 of file interp.\-c.

\hypertarget{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}{\index{interp.\-c@{interp.\-c}!cic\-Req\-Recv@{cic\-Req\-Recv}}
\index{cic\-Req\-Recv@{cic\-Req\-Recv}!interp.c@{interp.\-c}}
\subsubsection[{cic\-Req\-Recv}]{\setlength{\rightskip}{0pt plus 5cm}M\-P\-I\-\_\-\-Request $\ast$ cic\-Req\-Recv}}\label{interp_8c_a63b72f0c32960cd3ecc1733f30c40214}


Definition at line 41 of file interp.\-c.

\hypertarget{interp_8c_ae3d471e7732a1f671ffe978fcd723912}{\index{interp.\-c@{interp.\-c}!cic\-Req\-Send@{cic\-Req\-Send}}
\index{cic\-Req\-Send@{cic\-Req\-Send}!interp.c@{interp.\-c}}
\subsubsection[{cic\-Req\-Send}]{\setlength{\rightskip}{0pt plus 5cm}M\-P\-I\-\_\-\-Request$\ast$ cic\-Req\-Send}}\label{interp_8c_ae3d471e7732a1f671ffe978fcd723912}


Definition at line 41 of file interp.\-c.

\hypertarget{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}{\index{interp.\-c@{interp.\-c}!cic\-Sender@{cic\-Sender}}
\index{cic\-Sender@{cic\-Sender}!interp.c@{interp.\-c}}
\subsubsection[{cic\-Sender}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ cic\-Sender}}\label{interp_8c_a2a5d63a8f1ea342e89fe82d9bfa34dc4}


Definition at line 38 of file interp.\-c.

\hypertarget{interp_8c_a4a5d5cd735e0be12043322e83f096e15}{\index{interp.\-c@{interp.\-c}!lower\-Patch\-Corner@{lower\-Patch\-Corner}}
\index{lower\-Patch\-Corner@{lower\-Patch\-Corner}!interp.c@{interp.\-c}}
\subsubsection[{lower\-Patch\-Corner}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf int64\-Vector3d}$\ast$ lower\-Patch\-Corner}}\label{interp_8c_a4a5d5cd735e0be12043322e83f096e15}


Definition at line 45 of file interp.\-c.

\hypertarget{interp_8c_a2376cd58453249d9c7665fa650751766}{\index{interp.\-c@{interp.\-c}!lower\-Patch\-Corner\-R@{lower\-Patch\-Corner\-R}}
\index{lower\-Patch\-Corner\-R@{lower\-Patch\-Corner\-R}!interp.c@{interp.\-c}}
\subsubsection[{lower\-Patch\-Corner\-R}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf int64\-Vector3d}$\ast$ lower\-Patch\-Corner\-R}}\label{interp_8c_a2376cd58453249d9c7665fa650751766}


Definition at line 46 of file interp.\-c.

\hypertarget{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}{\index{interp.\-c@{interp.\-c}!patch\-Size@{patch\-Size}}
\index{patch\-Size@{patch\-Size}!interp.c@{interp.\-c}}
\subsubsection[{patch\-Size}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf int64\-Vector3d}$\ast$ patch\-Size}}\label{interp_8c_a63c4dd6e4bd05dfdc1e3b01c60b96c31}


Definition at line 47 of file interp.\-c.

\hypertarget{interp_8c_a55ace146e560886795409d6ac149119c}{\index{interp.\-c@{interp.\-c}!recv\-P@{recv\-P}}
\index{recv\-P@{recv\-P}!interp.c@{interp.\-c}}
\subsubsection[{recv\-P}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ recv\-P}}\label{interp_8c_a55ace146e560886795409d6ac149119c}


Definition at line 43 of file interp.\-c.

\hypertarget{interp_8c_a1ad7766a77930978570efda9dc79c423}{\index{interp.\-c@{interp.\-c}!upper\-Patch\-Corner@{upper\-Patch\-Corner}}
\index{upper\-Patch\-Corner@{upper\-Patch\-Corner}!interp.c@{interp.\-c}}
\subsubsection[{upper\-Patch\-Corner}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf int64\-Vector3d} $\ast$ upper\-Patch\-Corner}}\label{interp_8c_a1ad7766a77930978570efda9dc79c423}


Definition at line 45 of file interp.\-c.

\hypertarget{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}{\index{interp.\-c@{interp.\-c}!upper\-Patch\-Corner\-R@{upper\-Patch\-Corner\-R}}
\index{upper\-Patch\-Corner\-R@{upper\-Patch\-Corner\-R}!interp.c@{interp.\-c}}
\subsubsection[{upper\-Patch\-Corner\-R}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf int64\-Vector3d} $\ast$ upper\-Patch\-Corner\-R}}\label{interp_8c_a6a5d325724a8a8e583d58f951412aa0f}


Definition at line 46 of file interp.\-c.

