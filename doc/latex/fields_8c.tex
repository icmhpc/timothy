\hypertarget{fields_8c}{\section{fields.\-c File Reference}
\label{fields_8c}\index{fields.\-c@{fields.\-c}}
}


contains driving functions for the global fields  


{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include \char`\"{}global.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fields.\-h\char`\"{}}\\*
Include dependency graph for fields.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{fields_8c_af20f777e99b72945b22c053d2f7b8e46}{fields\-Init} ()
\item 
void \hyperlink{fields_8c_a8aa63d2a1c91ca03cb71cfc867e40c74}{fields\-Solve} ()
\item 
void \hyperlink{fields_8c_a582e88e9fb1bce076ff733084b35c115}{allocate\-Field\-Gradient} ()
\item 
void \hyperlink{fields_8c_a65a21aa9797f80765a167ebccc923c7f}{init\-Field\-Halo\-Exchange} (int chf)
\item 
void \hyperlink{fields_8c_ad08174d63d4750c8d6661144e3f3bb1c}{wait\-Field\-Halo\-Exchange} ()
\item 
void \hyperlink{fields_8c_ad83000b914316331bf7d3b66c53a289d}{compute\-Field\-Gradient} (int chf)
\item 
void \hyperlink{fields_8c_a2b1cba77aa657bc348ed055d89bfbe50}{field\-Gradient} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
contains driving functions for the global fields 

Definition in file \hyperlink{fields_8c_source}{fields.\-c}.



\subsection{Function Documentation}
\hypertarget{fields_8c_a582e88e9fb1bce076ff733084b35c115}{\index{fields.\-c@{fields.\-c}!allocate\-Field\-Gradient@{allocate\-Field\-Gradient}}
\index{allocate\-Field\-Gradient@{allocate\-Field\-Gradient}!fields.c@{fields.\-c}}
\subsubsection[{allocate\-Field\-Gradient}]{\setlength{\rightskip}{0pt plus 5cm}void allocate\-Field\-Gradient (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{fields_8c_a582e88e9fb1bce076ff733084b35c115}


Definition at line 189 of file fields.\-c.



References gfields, grid\-Size, halo\-R\-X0, halo\-R\-X1, halo\-R\-Y0, halo\-R\-Y1, halo\-R\-Z0, halo\-R\-Z1, halo\-S\-X0, halo\-S\-X1, halo\-S\-Y0, halo\-S\-Y1, halo\-S\-Z0, halo\-S\-Z1, M\-P\-I\-\_\-\-C\-A\-R\-T\-\_\-\-C\-O\-M\-M, r\-X0, r\-X1, r\-Y0, r\-Y1, r\-Z0, r\-Z1, int64\-Vector3d\-::x, int64\-Vector3d\-::y, and int64\-Vector3d\-::z.


\begin{DoxyCode}
190 \{
191 
192   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
193     \textcolor{keywordflow}{return};
194 
195   MPI\_Cart\_shift(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},0,1,&\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0},&\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1});
196   MPI\_Cart\_shift(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},1,1,&\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0},&\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1});
197   MPI\_Cart\_shift(\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},2,1,&\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0},&\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1});
198 
199   \textcolor{comment}{/* allocate send buffers */}
200   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a5b1a6ed0ad91a58cc9c9e48eba217643}{haloSX0}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
201   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_abcd411d2d371bb75abb7c2d89aac1265}{haloSX1}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
202   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_ab8d502d0d87b4e406600573e62b06f28}{haloSY0}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
203   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_af601c47ad6c97b079ce66bba7e7b2a24}{haloSY1}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
204   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a421410f629046ce8c9eaea51123ae34d}{haloSZ0}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
205   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a4e1a5f725f1e3695a8b11d27ac45b905}{haloSZ1}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
206 
207   \textcolor{comment}{/* allocate receive buffers */}
208   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_aa455b936396c224d389201ecf4b94368}{haloRX0}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
209   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a028e4eb118e3c99a36504c722fdd498f}{haloRX1}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
210   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a361933efde31efd4609c2ced0f74f4e1}{haloRY0}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
211   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_ae3b1497d0e550e0ae7f11870a12886f5}{haloRY1}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
212   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a8f084698e89cc616937d46dcb1308a1b}{haloRZ0}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
213   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_afc3a2c260c70eaca8afbf0785ab283f7}{haloRZ1}=(\textcolor{keywordtype}{double}*)calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
214 
215   \textcolor{keywordflow}{return};
216 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_a582e88e9fb1bce076ff733084b35c115_icgraph}
\end{center}
\end{figure}


\hypertarget{fields_8c_ad83000b914316331bf7d3b66c53a289d}{\index{fields.\-c@{fields.\-c}!compute\-Field\-Gradient@{compute\-Field\-Gradient}}
\index{compute\-Field\-Gradient@{compute\-Field\-Gradient}!fields.c@{fields.\-c}}
\subsubsection[{compute\-Field\-Gradient}]{\setlength{\rightskip}{0pt plus 5cm}void compute\-Field\-Gradient (
\begin{DoxyParamCaption}
\item[{int}]{chf}
\end{DoxyParamCaption}
)}}\label{fields_8c_ad83000b914316331bf7d3b66c53a289d}


Definition at line 311 of file fields.\-c.



References field\-Addr, gfields, grad\-Addr, grid\-Resolution, grid\-Size, halo\-R\-X0, halo\-R\-X1, halo\-R\-Y0, halo\-R\-Y1, halo\-R\-Z0, halo\-R\-Z1, halo\-S\-X0, halo\-S\-X1, halo\-S\-Y0, halo\-S\-Y1, halo\-S\-Z0, halo\-S\-Z1, N\-G\-L\-O\-B, r\-X0, r\-X1, r\-Y0, r\-Y1, r\-Z0, r\-Z1, wait\-Field\-Halo\-Exchange(), int64\-Vector3d\-::x, int64\-Vector3d\-::y, and int64\-Vector3d\-::z.


\begin{DoxyCode}
312 \{
313   \textcolor{keywordtype}{int} i,j,k;
314   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
315     \textcolor{keywordflow}{return};
316   \textcolor{comment}{/* compute internal data */}
317   \textcolor{keywordflow}{for}(i=0; i<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
318     \textcolor{keywordflow}{for}(j=0; j<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
319       \textcolor{keywordflow}{for}(k=0; k<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k++) \{
320         \textcolor{comment}{/* x coord gradient */}
321         \textcolor{keywordflow}{if}(i!=0 && i!=\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}-1) \{
322           \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+3*k+0]=
323             (\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*(i+1)+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k]
324              -\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*(i-1)+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k])/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
325 
326         \}
327         \textcolor{comment}{/* y coord gradient */}
328         \textcolor{keywordflow}{if}(j!=0 && j!=\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}-1) \{
329           \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+3*k+1]=
330             (\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*(j+1)+k]
331              -\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*(j-1)+k])/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
332         \}
333         \textcolor{comment}{/* z coord gradient */}
334         \textcolor{keywordflow}{if}(k!=0 && k!=\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}-1) \{
335           \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+3*k+2]=
336             (\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k+1]
337              -\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k-1])/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
338 
339         \}
340       \}
341   \textcolor{comment}{/* wait for boundary data to arrive */}
342   \hyperlink{fields_8c_ad08174d63d4750c8d6661144e3f3bb1c}{waitFieldHaloExchange}();
343   \textcolor{comment}{/* update with boundary data */}
344   \textcolor{keywordflow}{for}(j=0; j<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
345     \textcolor{keywordflow}{for}(k=0; k<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k++) \{
346       \textcolor{keywordtype}{double} x0,x1;
347       \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0}!=MPI\_PROC\_NULL) x0=\hyperlink{fields_8h_aa455b936396c224d389201ecf4b94368}{haloRX0}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k];
348       \textcolor{keywordflow}{else} x0=\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*0+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k];
349       \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1}!=MPI\_PROC\_NULL) x1=\hyperlink{fields_8h_a028e4eb118e3c99a36504c722fdd498f}{haloRX1}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k];
350       \textcolor{keywordflow}{else} x1=\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}-1)+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k];
351       \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*0+3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+3*k+0]=
352         (\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*1+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k]
353          - x0)/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
354       \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}-1)+3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+3*k+0]=
355         (x1
356          - \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}-2)+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k])/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
357     \}
358   \textcolor{keywordflow}{for}(i=0; i<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
359     \textcolor{keywordflow}{for}(k=0; k<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k++) \{
360       \textcolor{keywordtype}{double} y0,y1;
361       \textcolor{keywordflow}{if}(\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0}!=MPI\_PROC\_NULL) y0=\hyperlink{fields_8h_a361933efde31efd4609c2ced0f74f4e1}{haloRY0}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*i+k];
362       \textcolor{keywordflow}{else} y0=\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*0+k];
363       \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1}!=MPI\_PROC\_NULL) y1=\hyperlink{fields_8h_ae3b1497d0e550e0ae7f11870a12886f5}{haloRY1}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*i+k];
364       \textcolor{keywordflow}{else} y1=\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}-1)+k];
365       \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+3*
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*0+3*k+1]=
366         (\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*1+k]
367          - y0)/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
368       gradAddr[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}-1)+3*k+1]=
369         (y1
370          - \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}-2)+k])/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
371     \}
372   \textcolor{keywordflow}{for}(i=0; i<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
373     \textcolor{keywordflow}{for}(j=0; j<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++) \{
374       \textcolor{keywordtype}{double} z0,z1;
375       \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0}!=MPI\_PROC\_NULL) z0=\hyperlink{fields_8h_a8f084698e89cc616937d46dcb1308a1b}{haloRZ0}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+j];
376       \textcolor{keywordflow}{else} z0=\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+0];
377       \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1}!=MPI\_PROC\_NULL) z1=\hyperlink{fields_8h_afc3a2c260c70eaca8afbf0785ab283f7}{haloRZ1}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+j];
378       \textcolor{keywordflow}{else} z1=\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}-1)];
379       gradAddr[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+3*0+2]=
380         (\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+1]
381          - z0)/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
382       gradAddr[chf][3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+3*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+3*(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}-1)+2]=
383         (z1
384          - \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}-2)])/\hyperlink{fields_8h_a1c1b24172891a639f9cad84edebeaee9}{gridResolution};
385     \}
386 
387   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0}!=MPI\_PROC\_NULL) \{
388     free(\hyperlink{fields_8h_a5b1a6ed0ad91a58cc9c9e48eba217643}{haloSX0});
389     free(\hyperlink{fields_8h_aa455b936396c224d389201ecf4b94368}{haloRX0});
390   \}
391   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1}!=MPI\_PROC\_NULL) \{
392     free(\hyperlink{fields_8h_abcd411d2d371bb75abb7c2d89aac1265}{haloSX1});
393     free(\hyperlink{fields_8h_a028e4eb118e3c99a36504c722fdd498f}{haloRX1});
394   \}
395   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0}!=MPI\_PROC\_NULL) \{
396     free(\hyperlink{fields_8h_ab8d502d0d87b4e406600573e62b06f28}{haloSY0});
397     free(\hyperlink{fields_8h_a361933efde31efd4609c2ced0f74f4e1}{haloRY0});
398   \}
399   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1}!=MPI\_PROC\_NULL) \{
400     free(\hyperlink{fields_8h_af601c47ad6c97b079ce66bba7e7b2a24}{haloSY1});
401     free(\hyperlink{fields_8h_ae3b1497d0e550e0ae7f11870a12886f5}{haloRY1});
402   \}
403   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0}!=MPI\_PROC\_NULL) \{
404     free(\hyperlink{fields_8h_a421410f629046ce8c9eaea51123ae34d}{haloSZ0});
405     free(\hyperlink{fields_8h_a8f084698e89cc616937d46dcb1308a1b}{haloRZ0});
406   \}
407   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1}!=MPI\_PROC\_NULL) \{
408     free(\hyperlink{fields_8h_a4e1a5f725f1e3695a8b11d27ac45b905}{haloSZ1});
409     free(\hyperlink{fields_8h_afc3a2c260c70eaca8afbf0785ab283f7}{haloRZ1});
410   \}
411 
412   \textcolor{keywordflow}{return};
413 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_ad83000b914316331bf7d3b66c53a289d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_ad83000b914316331bf7d3b66c53a289d_icgraph}
\end{center}
\end{figure}


\hypertarget{fields_8c_a2b1cba77aa657bc348ed055d89bfbe50}{\index{fields.\-c@{fields.\-c}!field\-Gradient@{field\-Gradient}}
\index{field\-Gradient@{field\-Gradient}!fields.c@{fields.\-c}}
\subsubsection[{field\-Gradient}]{\setlength{\rightskip}{0pt plus 5cm}void field\-Gradient (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{fields_8c_a2b1cba77aa657bc348ed055d89bfbe50}


Definition at line 415 of file fields.\-c.



References allocate\-Field\-Gradient(), compute\-Field\-Gradient(), gfields, G\-L\-U\-C, glucose, H\-Y\-D\-R, hydrogen\-Ion, init\-Field\-Halo\-Exchange(), N\-C\-H\-E\-M, N\-G\-L\-O\-B, O\-X\-Y\-G, and oxygen.


\begin{DoxyCode}
416 \{
417   \textcolor{keywordtype}{int} chf;
418   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
419     \textcolor{keywordflow}{return};
420   \hyperlink{fields_8c_a582e88e9fb1bce076ff733084b35c115}{allocateFieldGradient}();
421   \textcolor{keywordflow}{for}(chf=0; chf<\hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}; chf++) \{
422     \textcolor{keywordflow}{if}(chf==\hyperlink{fields_8h_a5e74e9586fb0eac40835526c74bcb0bc}{OXYG}-\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB} && !\hyperlink{fields_8h_a67dd60f843bcdd47eb1503456d0da5de}{oxygen}) \textcolor{keywordflow}{continue};
423     \textcolor{keywordflow}{if}(chf==\hyperlink{fields_8h_acc998936c8c53109a36722f057e21352}{GLUC}-\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB} && !\hyperlink{fields_8h_aa70f92ad44ec1687a70b41b3c3e5fa45}{glucose}) \textcolor{keywordflow}{continue};
424     \textcolor{keywordflow}{if}(chf==\hyperlink{fields_8h_a985ad19b505d54de3ae5d490dfb2e8c5}{HYDR}-\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB} && !\hyperlink{fields_8h_a0bd8292376c22b63b67fc99aa6f51986}{hydrogenIon}) \textcolor{keywordflow}{continue};
425     \hyperlink{fields_8c_a65a21aa9797f80765a167ebccc923c7f}{initFieldHaloExchange}(chf);
426     \textcolor{comment}{//waitFieldHaloExchange();}
427     \hyperlink{fields_8c_ad83000b914316331bf7d3b66c53a289d}{computeFieldGradient}(chf);
428 
429   \}
430   \textcolor{keywordflow}{return};
431 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_a2b1cba77aa657bc348ed055d89bfbe50_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{fields_8c_a2b1cba77aa657bc348ed055d89bfbe50_icgraph}
\end{center}
\end{figure}


\hypertarget{fields_8c_af20f777e99b72945b22c053d2f7b8e46}{\index{fields.\-c@{fields.\-c}!fields\-Init@{fields\-Init}}
\index{fields\-Init@{fields\-Init}!fields.c@{fields.\-c}}
\subsubsection[{fields\-Init}]{\setlength{\rightskip}{0pt plus 5cm}void fields\-Init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{fields_8c_af20f777e99b72945b22c053d2f7b8e46}
This function intializes the fields. Various parameters are set and the Hypre initialization of the system is executed. 

Definition at line 45 of file fields.\-c.



References bvsim, chem\-Env\-Init\-B\-C(), chem\-Env\-Init\-Solver(), chem\-Env\-Init\-System(), chem\-Field, field\-Addr, field\-B\-C, field\-Critical\-Level1, field\-Critical\-Level2, field\-Diff\-Coef, field\-Dt, field\-I\-C\-Mean, field\-I\-C\-Var, field\-Name, field\-Type, gf\-Dt, gfields, glucose, grad\-Addr, grid\-Size, hydrogen\-Ion, N\-C\-H\-E\-M, oxygen, S\-C\-A\-L\-A\-R\-\_\-\-F\-I\-E\-L\-D, seconds\-Per\-Step, temp\-Env\-Init\-B\-C(), temp\-Env\-Init\-Solver(), temp\-Env\-Init\-System(), temperature, temp\-Field, tissue\-Field, vessel\-Field, int64\-Vector3d\-::x, int64\-Vector3d\-::y, and int64\-Vector3d\-::z.


\begin{DoxyCode}
46 \{
47   \textcolor{keywordtype}{int} nf, i;
48   \textcolor{keywordtype}{int} chf;
49 
50   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
51     \textcolor{keywordflow}{return};
52 
53   nf = 0;
54 
55   strcpy(\hyperlink{fields_8h_a1a12b04329495ce82cf21a9d42b71f1c}{fieldName}[nf], \textcolor{stringliteral}{"tissue"});
56   \hyperlink{fields_8h_a45d95417be1408a38916e94c79cb9e02}{fieldType}[nf] = \hyperlink{fields_8h_a5f8e3ee6c3157997836b1bbbecfba795}{SCALAR\_FIELD};
57   \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf] =
58     (\textcolor{keywordtype}{double} *) calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},
59                       \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
60   \hyperlink{fields_8h_a55b7734feef0881a48041f5c8b0fe434}{tissueField} = (\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf];
61   \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; i++)
62     \hyperlink{fields_8h_a55b7734feef0881a48041f5c8b0fe434}{tissueField}[i] = 0.0;
63   nf++;
64 
65   \textcolor{keywordflow}{if}(\hyperlink{global_8h_a975a504c34469eed96d609d621cfa35a}{bvsim}) \{
66     strcpy(\hyperlink{fields_8h_a1a12b04329495ce82cf21a9d42b71f1c}{fieldName}[nf], \textcolor{stringliteral}{"vessel"});
67     \hyperlink{fields_8h_a45d95417be1408a38916e94c79cb9e02}{fieldType}[nf] = \hyperlink{fields_8h_a5f8e3ee6c3157997836b1bbbecfba795}{SCALAR\_FIELD};
68     \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf] =
69       (\textcolor{keywordtype}{double} *) calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},
70                         \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
71     \hyperlink{fields_8h_a6ef295c3b0816bc488287d089220ac10}{vesselField} = (\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf];
72     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; i++)
73       \hyperlink{fields_8h_a6ef295c3b0816bc488287d089220ac10}{vesselField}[i] = 0.0;
74   \}
75   nf++;
76 
77   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a0ac2a299549fcca3cd14e4c1ac2087d2}{temperature}) \{
78     strcpy(\hyperlink{fields_8h_a1a12b04329495ce82cf21a9d42b71f1c}{fieldName}[nf], \textcolor{stringliteral}{"temp"});
79     \hyperlink{fields_8h_a45d95417be1408a38916e94c79cb9e02}{fieldType}[nf] = \hyperlink{fields_8h_a5f8e3ee6c3157997836b1bbbecfba795}{SCALAR\_FIELD};
80     \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf] =
81       (\textcolor{keywordtype}{double} *) calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},
82                         \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
83     \hyperlink{fields_8h_afffa6ff788240a58e074a58603f3d11e}{tempField} = (\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf];
84     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; i++)
85       \hyperlink{fields_8h_afffa6ff788240a58e074a58603f3d11e}{tempField}[i] = 0.0;
86     \hyperlink{fields_8h_ad4870e0beb9744bd643b6501c4505d81}{fieldDiffCoef}[nf] = 1 * 1e-5;
87     \hyperlink{fields_8h_a80c6ee80e0f056adba2430ab0d21e58f}{fieldBC}[nf] = 42.0;
88     \hyperlink{fields_8h_ad0fb86debb3e1b138683ff94a2f51f5b}{fieldICMean}[nf] = 36.0;
89     \hyperlink{fields_8h_ad7e273c70cc0bf1510948fce547960f4}{fieldICVar}[nf] = 0;
90   \}
91   nf++;
92 
93   \textcolor{comment}{/* set default values for chemical parameters */}
94   \textcolor{keywordflow}{for} (chf = 0; chf < \hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}; chf++) \{
95     \textcolor{keywordflow}{if}(chf==0 && !\hyperlink{fields_8h_a67dd60f843bcdd47eb1503456d0da5de}{oxygen}) \{
96       nf++;
97       \textcolor{keywordflow}{continue};
98     \}
99     \textcolor{keywordflow}{if}(chf==1 && !\hyperlink{fields_8h_aa70f92ad44ec1687a70b41b3c3e5fa45}{glucose}) \{
100       nf++;
101       \textcolor{keywordflow}{continue};
102     \}
103     \textcolor{keywordflow}{if}(chf==2 && !\hyperlink{fields_8h_a0bd8292376c22b63b67fc99aa6f51986}{hydrogenIon}) \{
104       nf++;
105       \textcolor{keywordflow}{continue};
106     \}
107     \textcolor{keywordflow}{if} (chf == 0) \{
108       strcpy(\hyperlink{fields_8h_a1a12b04329495ce82cf21a9d42b71f1c}{fieldName}[nf], \textcolor{stringliteral}{"oxygen"});
109       \hyperlink{fields_8h_ae21d99cc23aefdfc02fbe62cd28784fb}{fieldDt}[nf] = \hyperlink{global_8h_aae6a1dda703fb50b7a8b0f4dc01d82c1}{gfDt};
110       \hyperlink{fields_8h_a3d0360f40f207ac596765b891c46b285}{fieldCriticalLevel1}[nf] *= \hyperlink{global_8h_aae6a1dda703fb50b7a8b0f4dc01d82c1}{gfDt};   \textcolor{comment}{//*(boxVolume/cellVolume);}
111       \hyperlink{fields_8h_a5534681dc803f20910d872026257fd75}{fieldCriticalLevel2}[nf] *= \hyperlink{global_8h_aae6a1dda703fb50b7a8b0f4dc01d82c1}{gfDt};   \textcolor{comment}{//*(boxVolume/cellVolume);}
112     \}
113     \textcolor{keywordflow}{if} (chf == 1) \{
114       strcpy(\hyperlink{fields_8h_a1a12b04329495ce82cf21a9d42b71f1c}{fieldName}[nf], \textcolor{stringliteral}{"glucose"});
115       \hyperlink{fields_8h_ae21d99cc23aefdfc02fbe62cd28784fb}{fieldDt}[nf] = \hyperlink{global_8h_aac71dcf068b84f2973571ab102920190}{secondsPerStep};
116     \}
117     \textcolor{keywordflow}{if} (chf == 2) \{
118       strcpy(\hyperlink{fields_8h_a1a12b04329495ce82cf21a9d42b71f1c}{fieldName}[nf], \textcolor{stringliteral}{"hydrogenIon"});
119       \hyperlink{fields_8h_ae21d99cc23aefdfc02fbe62cd28784fb}{fieldDt}[nf] = \hyperlink{global_8h_aac71dcf068b84f2973571ab102920190}{secondsPerStep};
120     \}
121     \hyperlink{fields_8h_a45d95417be1408a38916e94c79cb9e02}{fieldType}[nf] = \hyperlink{fields_8h_a5f8e3ee6c3157997836b1bbbecfba795}{SCALAR\_FIELD};
122     \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf] =
123       (\textcolor{keywordtype}{double} *) calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},
124                         \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
125     \hyperlink{fields_8h_adb9b18c97bd0384bf977ee57e604626a}{chemField}[chf] = (\textcolor{keywordtype}{double} *) \hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[nf];
126 
127     \textcolor{comment}{/* gradient allocation */}
128     \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf] = (\textcolor{keywordtype}{double}*) calloc(\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z} * 3, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));
129 
130     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y} * \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; i++)
131       \hyperlink{fields_8h_adb9b18c97bd0384bf977ee57e604626a}{chemField}[chf][i] = 0.0;
132 
133     \textcolor{keywordflow}{for} (i=0; i<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*3; i++)
134       \hyperlink{fields_8h_a74ba67ff9d715f5cc482b96ad9fdfe1e}{gradAddr}[chf][i] = 0.0;
135 
136     nf++;
137   \}
138 
139   \textcolor{comment}{/* initialize temperature field */}
140   \textcolor{keywordflow}{if} (\hyperlink{fields_8h_a0ac2a299549fcca3cd14e4c1ac2087d2}{temperature}) \{
141     \hyperlink{tempf_8c_afdd72425d842d0527b7707235c6b1426}{tempEnvInitSystem}();
142     \hyperlink{tempf_8c_aa500322cb37c8e4f6b5cdd19f7f4c52a}{tempEnvInitBC}();
143     \hyperlink{tempf_8c_a03c57aff346d1ca0f30a1cbe5d74110d}{tempEnvInitSolver}();
144   \}
145 
146   \textcolor{comment}{/* initialize chemical fields */}
147   \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}; i++) \{
148     \textcolor{keywordflow}{if} (i == 0 && !\hyperlink{fields_8h_a67dd60f843bcdd47eb1503456d0da5de}{oxygen})
149       \textcolor{keywordflow}{continue};
150     \textcolor{keywordflow}{if} (i == 1 && !\hyperlink{fields_8h_aa70f92ad44ec1687a70b41b3c3e5fa45}{glucose})
151       \textcolor{keywordflow}{continue};
152     \textcolor{keywordflow}{if} (i == 2 && !\hyperlink{fields_8h_a0bd8292376c22b63b67fc99aa6f51986}{hydrogenIon})
153       \textcolor{keywordflow}{continue};
154     \hyperlink{chemf_8c_abc9d0a6b17feeff2a62eb6bb38c17ff4}{chemEnvInitSystem}(i);
155     \hyperlink{chemf_8c_ae67d4d36ecee14805a0b6b0b134b0800}{chemEnvInitBC}(i);
156     \hyperlink{chemf_8c_ad1be1b100191d6ffbd5c3cb0c42549d6}{chemEnvInitSolver}(i);
157   \}
158 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_af20f777e99b72945b22c053d2f7b8e46_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{fields_8c_af20f777e99b72945b22c053d2f7b8e46_icgraph}
\end{center}
\end{figure}


\hypertarget{fields_8c_a8aa63d2a1c91ca03cb71cfc867e40c74}{\index{fields.\-c@{fields.\-c}!fields\-Solve@{fields\-Solve}}
\index{fields\-Solve@{fields\-Solve}!fields.c@{fields.\-c}}
\subsubsection[{fields\-Solve}]{\setlength{\rightskip}{0pt plus 5cm}void fields\-Solve (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{fields_8c_a8aa63d2a1c91ca03cb71cfc867e40c74}
This is a driving function for global field solver. It is called in each step of the simulation. 

Definition at line 164 of file fields.\-c.



References chem\-Env\-Solve(), gfields, gf\-Iter, gf\-Iter\-Per\-Step, glucose, hydrogen\-Ion, N\-C\-H\-E\-M, oxygen, temp\-Env\-Solve(), temperature, and update\-Cell\-States().


\begin{DoxyCode}
165 \{
166   \textcolor{keywordtype}{int} i;
167   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
168     \textcolor{keywordflow}{return};
169   \textcolor{keywordflow}{for} (\hyperlink{global_8h_ab2e483b60cc15741bd6281688f31edbc}{gfIter} = 0; \hyperlink{global_8h_ab2e483b60cc15741bd6281688f31edbc}{gfIter} < \hyperlink{global_8h_a4b76c15679db05e32f70c9804e186557}{gfIterPerStep}; \hyperlink{global_8h_ab2e483b60cc15741bd6281688f31edbc}{gfIter}++) \{
170     \textcolor{comment}{/* update cell state (if more than one iteration) */}
171     \textcolor{keywordflow}{if} (\hyperlink{global_8h_ab2e483b60cc15741bd6281688f31edbc}{gfIter} > 0)
172       \hyperlink{cells_8c_aeb1f066ef0713a8a50eb1e58784a3d7b}{updateCellStates}();
173     \textcolor{comment}{/* solve temperature field */}
174     \textcolor{keywordflow}{if} (\hyperlink{fields_8h_a0ac2a299549fcca3cd14e4c1ac2087d2}{temperature})
175       \hyperlink{tempf_8c_a7e47d73682b9a931fd9d680f6d495331}{tempEnvSolve}();
176     \textcolor{comment}{/* solve chemical fields */}
177     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{fields_8h_af4afd37668ae33da6377a17adff33029}{NCHEM}; i++) \{
178       \textcolor{keywordflow}{if} (i == 0 && !\hyperlink{fields_8h_a67dd60f843bcdd47eb1503456d0da5de}{oxygen})
179         \textcolor{keywordflow}{continue};
180       \textcolor{keywordflow}{if} (i == 1 && !\hyperlink{fields_8h_aa70f92ad44ec1687a70b41b3c3e5fa45}{glucose})
181         \textcolor{keywordflow}{continue};
182       \textcolor{keywordflow}{if} (i == 2 && !\hyperlink{fields_8h_a0bd8292376c22b63b67fc99aa6f51986}{hydrogenIon})
183         \textcolor{keywordflow}{continue};
184       \hyperlink{chemf_8c_a1f8f7d186d46aafcd792aaf3bee655a7}{chemEnvSolve}(i);
185     \}
186   \}
187 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_a8aa63d2a1c91ca03cb71cfc867e40c74_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{fields_8c_a8aa63d2a1c91ca03cb71cfc867e40c74_icgraph}
\end{center}
\end{figure}


\hypertarget{fields_8c_a65a21aa9797f80765a167ebccc923c7f}{\index{fields.\-c@{fields.\-c}!init\-Field\-Halo\-Exchange@{init\-Field\-Halo\-Exchange}}
\index{init\-Field\-Halo\-Exchange@{init\-Field\-Halo\-Exchange}!fields.c@{fields.\-c}}
\subsubsection[{init\-Field\-Halo\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void init\-Field\-Halo\-Exchange (
\begin{DoxyParamCaption}
\item[{int}]{chf}
\end{DoxyParamCaption}
)}}\label{fields_8c_a65a21aa9797f80765a167ebccc923c7f}


Definition at line 218 of file fields.\-c.



References field\-Addr, gfields, grid\-Size, halo\-R\-X0, halo\-R\-X1, halo\-R\-Y0, halo\-R\-Y1, halo\-R\-Z0, halo\-R\-Z1, halo\-S\-X0, halo\-S\-X1, halo\-S\-Y0, halo\-S\-Y1, halo\-S\-Z0, halo\-S\-Z1, M\-P\-I\-\_\-\-C\-A\-R\-T\-\_\-\-C\-O\-M\-M, M\-P\-Irank, M\-P\-Isize, N\-G\-L\-O\-B, req\-F\-G\-Recv, req\-F\-G\-Send, r\-X0, r\-X1, r\-Y0, r\-Y1, r\-Z0, r\-Z1, int64\-Vector3d\-::x, int64\-Vector3d\-::y, and int64\-Vector3d\-::z.


\begin{DoxyCode}
219 \{
220   \textcolor{keywordtype}{int} i,j,k;
221   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
222     \textcolor{keywordflow}{return};
223 
224   \textcolor{keywordflow}{for}(i=0; i<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}; i++)
225     \textcolor{keywordflow}{for}(j=0; j<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}; j++)
226       \textcolor{keywordflow}{for}(k=0; k<\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}; k++) \{
227         \textcolor{keywordtype}{double} val;
228         val=\hyperlink{fields_8h_a6f2153921f2cf97a60e41a347ecaeb39}{fieldAddr}[\hyperlink{fields_8h_aa40ca56600c708a797a77c1db484958d}{NGLOB}+chf][\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.
      \hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k];
229         \textcolor{keywordflow}{if}(i==0 && \hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a5b1a6ed0ad91a58cc9c9e48eba217643}{haloSX0}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k]=val;
230         \textcolor{keywordflow}{if}(i==\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}-1 && \hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_abcd411d2d371bb75abb7c2d89aac1265}{haloSX1}[
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*j+k]=val;
231         \textcolor{keywordflow}{if}(j==0 && \hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_ab8d502d0d87b4e406600573e62b06f28}{haloSY0}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*i+k]=val;
232         \textcolor{keywordflow}{if}(j==\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}-1 && \hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_af601c47ad6c97b079ce66bba7e7b2a24}{haloSY1}[
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}*i+k]=val;
233         \textcolor{keywordflow}{if}(k==0 && \hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a421410f629046ce8c9eaea51123ae34d}{haloSZ0}[\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+j]=val;
234         \textcolor{keywordflow}{if}(k==\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z}-1 && \hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1}!=MPI\_PROC\_NULL) \hyperlink{fields_8h_a4e1a5f725f1e3695a8b11d27ac45b905}{haloSZ1}[
      \hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*i+j]=val;
235       \}
236 
237   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0}!=MPI\_PROC\_NULL) \{
238     MPI\_Isend(\hyperlink{fields_8h_a5b1a6ed0ad91a58cc9c9e48eba217643}{haloSX0},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0},\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[0]);
239     MPI\_Irecv(\hyperlink{fields_8h_aa455b936396c224d389201ecf4b94368}{haloRX0},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0},\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[0]);
240   \}
241   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1}!=MPI\_PROC\_NULL) \{
242     MPI\_Isend(\hyperlink{fields_8h_abcd411d2d371bb75abb7c2d89aac1265}{haloSX1},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1},\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[1]);
243     MPI\_Irecv(\hyperlink{fields_8h_a028e4eb118e3c99a36504c722fdd498f}{haloRX1},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1},\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[1]);
244   \}
245   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0}!=MPI\_PROC\_NULL) \{
246     MPI\_Isend(\hyperlink{fields_8h_ab8d502d0d87b4e406600573e62b06f28}{haloSY0},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0},2*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[2]);
247     MPI\_Irecv(\hyperlink{fields_8h_a361933efde31efd4609c2ced0f74f4e1}{haloRY0},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0},3*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[2]);
248   \}
249   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1}!=MPI\_PROC\_NULL) \{
250     MPI\_Isend(\hyperlink{fields_8h_af601c47ad6c97b079ce66bba7e7b2a24}{haloSY1},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1},3*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[3]);
251     MPI\_Irecv(\hyperlink{fields_8h_ae3b1497d0e550e0ae7f11870a12886f5}{haloRY1},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a44624880ae3bb63041297b70cb33408b}{z},MPI\_DOUBLE,
      \hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1},2*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[3]);
252   \}
253   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0}!=MPI\_PROC\_NULL) \{
254     MPI\_Isend(\hyperlink{fields_8h_a421410f629046ce8c9eaea51123ae34d}{haloSZ0},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},MPI\_DOUBLE,
      \hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0},4*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[4]);
255     MPI\_Irecv(\hyperlink{fields_8h_a8f084698e89cc616937d46dcb1308a1b}{haloRZ0},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},MPI\_DOUBLE,
      \hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0},5*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[4]);
256   \}
257   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1}!=MPI\_PROC\_NULL) \{
258     MPI\_Isend(\hyperlink{fields_8h_a4e1a5f725f1e3695a8b11d27ac45b905}{haloSZ1},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},MPI\_DOUBLE,
      \hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1},5*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{global_8h_a710288ab7d2734acc4566a87a645325d}{MPIrank},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[5]);
259     MPI\_Irecv(\hyperlink{fields_8h_afc3a2c260c70eaca8afbf0785ab283f7}{haloRZ1},\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a0cbcba26311a97b8e0763317e105a918}{y}*\hyperlink{fields_8h_ae67bb9d09bd0919a0ccbc27b387cec72}{gridSize}.\hyperlink{structint64Vector3d_a040359f45343ce6667f5c66fda5f50e3}{x},MPI\_DOUBLE,
      \hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1},4*\hyperlink{global_8h_a0d7d02544d01ceac87c9d5cadc3af0df}{MPIsize}+\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1},\hyperlink{global_8h_a34ac355617a6a906e1f3e7832aeb0073}{MPI\_CART\_COMM},&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[5]);
260   \}
261 
262   \textcolor{keywordflow}{return};
263 \}
\end{DoxyCode}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_a65a21aa9797f80765a167ebccc923c7f_icgraph}
\end{center}
\end{figure}


\hypertarget{fields_8c_ad08174d63d4750c8d6661144e3f3bb1c}{\index{fields.\-c@{fields.\-c}!wait\-Field\-Halo\-Exchange@{wait\-Field\-Halo\-Exchange}}
\index{wait\-Field\-Halo\-Exchange@{wait\-Field\-Halo\-Exchange}!fields.c@{fields.\-c}}
\subsubsection[{wait\-Field\-Halo\-Exchange}]{\setlength{\rightskip}{0pt plus 5cm}void wait\-Field\-Halo\-Exchange (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{fields_8c_ad08174d63d4750c8d6661144e3f3bb1c}


Definition at line 265 of file fields.\-c.



References gfields, req\-F\-G\-Recv, req\-F\-G\-Send, r\-X0, r\-X1, r\-Y0, r\-Y1, r\-Z0, r\-Z1, and stop\-Run().


\begin{DoxyCode}
266 \{
267   \textcolor{keywordflow}{if} (!\hyperlink{fields_8h_abe4692639a5f11507faff09f2d37efa8}{gfields})
268     \textcolor{keywordflow}{return};
269   MPI\_Status status;
270   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af04702287d6dec57802c81071212423f}{rX0}!=MPI\_PROC\_NULL) \{
271     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[0], &status) != MPI\_SUCCESS)
272       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
273     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[0], &status) != MPI\_SUCCESS)
274       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
275   \}
276   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a7c990eb627c166f119dddf7d0fe33285}{rX1}!=MPI\_PROC\_NULL) \{
277     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[1], &status) != MPI\_SUCCESS)
278       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
279     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[1], &status) != MPI\_SUCCESS)
280       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
281   \}
282   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_ac41b308e7a718a159727b7a08340b577}{rY0}!=MPI\_PROC\_NULL) \{
283     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[2], &status) != MPI\_SUCCESS)
284       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
285     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[2], &status) != MPI\_SUCCESS)
286       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
287   \}
288   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a72bac0e9dbb96427052c46a5dbb5675c}{rY1}!=MPI\_PROC\_NULL) \{
289     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[3], &status) != MPI\_SUCCESS)
290       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
291     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[3], &status) != MPI\_SUCCESS)
292       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
293   \}
294   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_af48da71f2b169dce2e4ae8da64f79cea}{rZ0}!=MPI\_PROC\_NULL) \{
295     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[4], &status) != MPI\_SUCCESS)
296       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
297     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[4], &status) != MPI\_SUCCESS)
298       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
299   \}
300   \textcolor{keywordflow}{if}(\hyperlink{fields_8h_a6698e8930956f935b86bf825e333f82e}{rZ1}!=MPI\_PROC\_NULL) \{
301     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_aa0e8b4fb8fd6e43d53d341cdfb7c34ef}{reqFGSend}[5], &status) != MPI\_SUCCESS)
302       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
303     \textcolor{keywordflow}{if} (MPI\_Wait(&\hyperlink{fields_8h_a4067b0240f9168c992e3e5e81d6bf4f2}{reqFGRecv}[5], &status) != MPI\_SUCCESS)
304       \hyperlink{utils_8c_a07dd99a04f2723be164531a7a862fb67}{stopRun}(103, \textcolor{stringliteral}{"reqFGSend"}, \_\_FILE\_\_, \_\_LINE\_\_);
305   \}
306 
307   \textcolor{keywordflow}{return};
308 \}
\end{DoxyCode}


Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=290pt]{fields_8c_ad08174d63d4750c8d6661144e3f3bb1c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fields_8c_ad08174d63d4750c8d6661144e3f3bb1c_icgraph}
\end{center}
\end{figure}


